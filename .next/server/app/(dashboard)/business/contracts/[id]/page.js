(()=>{var e={};e.id=8174,e.ids=[8174],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},54030:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>o}),s(95375),s(6989),s(35866),s(65161);var r=s(23191),n=s(88716),a=s(37922),l=s.n(a),i=s(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let o=["",{children:["(dashboard)",{children:["business",{children:["contracts",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,95375)),"C:\\Users\\totur\\OneDrive\\Documents\\Wennovate Consulting\\Internal Projects\\LocalTalents_ca\\LocalTalent-app\\src\\app\\(dashboard)\\business\\contracts\\[id]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6989)),"C:\\Users\\totur\\OneDrive\\Documents\\Wennovate Consulting\\Internal Projects\\LocalTalents_ca\\LocalTalent-app\\src\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,65161)),"C:\\Users\\totur\\OneDrive\\Documents\\Wennovate Consulting\\Internal Projects\\LocalTalents_ca\\LocalTalent-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\totur\\OneDrive\\Documents\\Wennovate Consulting\\Internal Projects\\LocalTalents_ca\\LocalTalent-app\\src\\app\\(dashboard)\\business\\contracts\\[id]\\page.tsx"],u="/(dashboard)/business/contracts/[id]/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(dashboard)/business/contracts/[id]/page",pathname:"/business/contracts/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},74815:(e,t,s)=>{Promise.resolve().then(s.bind(s,57606))},99899:(e,t,s)=>{"use strict";var r=s(56715);function n(){}function a(){}a.resetWarningCache=n,e.exports=function(){function e(e,t,s,n,a,l){if(l!==r){var i=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:n};return s.PropTypes=s,s}},78439:(e,t,s)=>{e.exports=s(99899)()},56715:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},57606:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eA});var r,n=s(10326),a=s(17577),l=s(35047),i=s(90434),c=s(91664),o=s(29752),d=s(38443),u=s(79763),m=s(7710),p=s(41217),x=s(37610),h=s(83401),f=s(14526),j=s(19381),y=s(86421),g=s(3719),b=s(60882),v=s(51223),N=s(78439);function w(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function C(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?w(Object(s),!0).forEach(function(t){S(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):w(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s,r,n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var a=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(s=n.next()).done)&&(a.push(s.value),!t||a.length!==t);l=!0);}catch(e){i=!0,r=e}finally{try{l||null==n.return||n.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return k(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);if("Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return k(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,r=Array(t);s<t;s++)r[s]=e[s];return r}var A=function(e,t,s){var r=!!s,n=a.useRef(s);a.useEffect(function(){n.current=s},[s]),a.useEffect(function(){if(!r||!e)return function(){};var s=function(){n.current&&n.current.apply(n,arguments)};return e.on(t,s),function(){e.off(t,s)}},[r,t,e,n])},O=function(e){var t=a.useRef(e);return a.useEffect(function(){t.current=e},[e]),t.current},T=function(e){return null!==e&&"object"===P(e)},D="[object Object]",R=function e(t,s){if(!T(t)||!T(s))return t===s;var r=Array.isArray(t);if(r!==Array.isArray(s))return!1;var n=Object.prototype.toString.call(t)===D;if(n!==(Object.prototype.toString.call(s)===D))return!1;if(!n&&!r)return t===s;var a=Object.keys(t),l=Object.keys(s);if(a.length!==l.length)return!1;for(var i={},c=0;c<a.length;c+=1)i[a[c]]=!0;for(var o=0;o<l.length;o+=1)i[l[o]]=!0;var d=Object.keys(i);return d.length===a.length&&d.every(function(r){return e(t[r],s[r])})},L=function(e,t,s){return T(e)?Object.keys(e).reduce(function(r,n){var a=!T(t)||!R(e[n],t[n]);return s.includes(n)?(a&&console.warn("Unsupported prop change: options.".concat(n," is not a mutable property.")),r):a?C(C({},r||{}),{},S({},n,e[n])):r},null):null},_="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(null===e||T(e)&&"function"==typeof e.elements&&"function"==typeof e.createToken&&"function"==typeof e.createPaymentMethod&&"function"==typeof e.confirmCardPayment)return e;throw Error(t)},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(T(e)&&"function"==typeof e.then)return{tag:"async",stripePromise:Promise.resolve(e).then(function(e){return I(e,t)})};var s=I(e,t);return null===s?{tag:"empty"}:{tag:"sync",stripe:s}},Z=function(e){e&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"5.2.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.2.0",url:"https://stripe.com/docs/stripe-js/react"}))},Y=a.createContext(null);Y.displayName="ElementsContext";var q=function(e,t){if(!e)throw Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},U=function(e){var t=e.stripe,s=e.options,r=e.children,n=a.useMemo(function(){return F(t)},[t]),l=E(a.useState(function(){return{stripe:"sync"===n.tag?n.stripe:null,elements:"sync"===n.tag?n.stripe.elements(s):null}}),2),i=l[0],c=l[1];a.useEffect(function(){var e=!0,t=function(e){c(function(t){return t.stripe?t:{stripe:e,elements:e.elements(s)}})};return"async"!==n.tag||i.stripe?"sync"!==n.tag||i.stripe||t(n.stripe):n.stripePromise.then(function(s){s&&e&&t(s)}),function(){e=!1}},[n,i,s]);var o=O(t);a.useEffect(function(){null!==o&&o!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[o,t]);var d=O(s);return a.useEffect(function(){if(i.elements){var e=L(s,d,["clientSecret","fonts"]);e&&i.elements.update(e)}},[s,d,i.elements]),a.useEffect(function(){Z(i.stripe)},[i.stripe]),a.createElement(Y.Provider,{value:i},r)};U.propTypes={stripe:N.any,options:N.object},N.func.isRequired;var z=a.createContext(null);z.displayName="CheckoutContext",N.any,N.shape({clientSecret:N.oneOfType([N.string,N.instanceOf(Promise)]).isRequired,elementsOptions:N.object}).isRequired;var M=function(e){var t=a.useContext(z),s=a.useContext(Y);if(!t)return q(s,e);if(!s)return t;throw Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."))},$=["mode"],H=function(e,t){var s="".concat(e.charAt(0).toUpperCase()+e.slice(1),"Element"),r=t?function(e){M("mounts <".concat(s,">"));var t=e.id,r=e.className;return a.createElement("div",{id:t,className:r})}:function(t){var r,n=t.id,l=t.className,i=t.options,c=void 0===i?{}:i,o=t.onBlur,d=t.onFocus,u=t.onReady,m=t.onChange,p=t.onEscape,x=t.onClick,h=t.onLoadError,f=t.onLoaderStart,j=t.onNetworksChange,y=t.onConfirm,g=t.onCancel,b=t.onShippingAddressChange,v=t.onShippingRateChange,N=t.onSavedPaymentMethodRemove,w=t.onSavedPaymentMethodUpdate,C=M("mounts <".concat(s,">")),P="elements"in C?C.elements:null,S="checkoutState"in C?C.checkoutState:null,k=(null==S?void 0:S.type)==="success"||(null==S?void 0:S.type)==="loading"?S.sdk:null,T=E(a.useState(null),2),D=T[0],R=T[1],_=a.useRef(null),I=a.useRef(null);A(D,"blur",o),A(D,"focus",d),A(D,"escape",p),A(D,"click",x),A(D,"loaderror",h),A(D,"loaderstart",f),A(D,"networkschange",j),A(D,"confirm",y),A(D,"cancel",g),A(D,"shippingaddresschange",b),A(D,"shippingratechange",v),A(D,"savedpaymentmethodremove",N),A(D,"savedpaymentmethodupdate",w),A(D,"change",m),u&&(r="expressCheckout"===e?u:function(){u(D)}),A(D,"ready",r),a.useLayoutEffect(function(){if(null===_.current&&null!==I.current&&(P||k)){var t=null;if(k)switch(e){case"payment":t=k.createPaymentElement(c);break;case"address":if("mode"in c){var r=c.mode,n=function(e,t){if(null==e)return{};var s,r,n=function(e,t){if(null==e)return{};var s,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)s=a[r],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)s=a[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}(c,$);if("shipping"===r)t=k.createShippingAddressElement(n);else if("billing"===r)t=k.createBillingAddressElement(n);else throw Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":t=k.createExpressCheckoutElement(c);break;case"currencySelector":t=k.createCurrencySelectorElement();break;case"taxId":t=k.createTaxIdElement(c);break;default:throw Error("Invalid Element type ".concat(s,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else P&&(t=P.create(e,c));_.current=t,R(t),t&&t.mount(I.current)}},[P,k,c]);var F=O(c);return a.useEffect(function(){if(_.current){var e=L(c,F,["paymentRequest"]);e&&"update"in _.current&&_.current.update(e)}},[c,F]),a.useLayoutEffect(function(){return function(){if(_.current&&"function"==typeof _.current.destroy)try{_.current.destroy(),_.current=null}catch(e){}}},[]),a.createElement("div",{id:n,className:l,ref:I})};return r.propTypes={id:N.string,className:N.string,onChange:N.func,onBlur:N.func,onFocus:N.func,onReady:N.func,onEscape:N.func,onClick:N.func,onLoadError:N.func,onLoaderStart:N.func,onNetworksChange:N.func,onConfirm:N.func,onCancel:N.func,onShippingAddressChange:N.func,onShippingRateChange:N.func,onSavedPaymentMethodRemove:N.func,onSavedPaymentMethodUpdate:N.func,options:N.object},r.displayName=s,r.__elementType=e,r},G="undefined"==typeof window;a.createContext(null).displayName="EmbeddedCheckoutProviderContext",H("auBankAccount",G);var B=H("card",G);H("cardNumber",G),H("cardExpiry",G),H("cardCvc",G),H("iban",G),H("payment",G),H("expressCheckout",G),H("paymentRequestButton",G),H("linkAuthentication",G),H("address",G),H("shippingAddress",G),H("paymentMethodMessaging",G),H("taxId",G);var W=s(90216),V=s(99733),K="clover",Q="https://js.stripe.com",X="".concat(Q,"/").concat(K,"/stripe.js"),J=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ee=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,et=function(){for(var e=document.querySelectorAll('script[src^="'.concat(Q,'"]')),t=0;t<e.length;t++){var s,r=e[t];if(s=r.src,J.test(s)||ee.test(s))return r}return null},es=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",s=document.createElement("script");s.src="".concat(X).concat(t);var r=document.head||document.body;if(!r)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(s),s},er=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"8.0.0",startTime:t})},en=null,ea=null,el=null,ei=function(e,t,s){if(null===e)return null;var r,n=t[0].match(/^pk_test/),a=3===(r=e.version)?"v3":r;n&&a!==K&&console.warn("Stripe.js@".concat(a," was loaded on the page, but @stripe/stripe-js@").concat("8.0.0"," expected Stripe.js@").concat(K,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var l=e.apply(void 0,t);return er(l,s),l},ec=!1,eo=function(){return r||(r=(null!==en?en:(en=new Promise(function(e,t){if("undefined"==typeof window||"undefined"==typeof document){e(null);return}if(window.Stripe,window.Stripe){e(window.Stripe);return}try{var s,r=et();r?r&&null!==el&&null!==ea&&(r.removeEventListener("load",el),r.removeEventListener("error",ea),null===(s=r.parentNode)||void 0===s||s.removeChild(r),r=es(null)):r=es(null),el=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},ea=function(e){t(Error("Failed to load Stripe.js",{cause:e}))},r.addEventListener("load",el),r.addEventListener("error",ea)}catch(e){t(e);return}})).catch(function(e){return en=null,Promise.reject(e)})).catch(function(e){return r=null,Promise.reject(e)}))};Promise.resolve().then(function(){return eo()}).catch(function(e){ec||console.warn(e)});let ed=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];ec=!0;var r=Date.now();return eo().then(function(e){return ei(e,t,r)})}("pk_test_51RnblaP5HirIJ0RzmLxLY1UqCYZgYjRPLqFqnO43HS74z6xgbiHcvqVOE1GtOeLY0ZxXDEbA7ji4MWUe2vu7ibgK00rbE04ufW");var eu=s(55137);let em=({paymentIntentId:e,clientSecret:t,amount:s,currency:r,contractId:l,onSuccess:i,onError:d})=>{var u;let m=M("calls useStripe()").stripe,p=(u="calls useElements()",q(a.useContext(Y),u)).elements,[x,h]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),[y,g]=(0,a.useState)(""),b=async e=>{if(e.preventDefault(),!m||!p)return;if(!y||y.trim().length<3){j("Please enter a valid postal code");return}h(!0),j(null);let s=p.getElement(B);if(!s){j("Card element not found"),h(!1);return}try{let{error:e,paymentIntent:r}=await m.confirmCardPayment(t,{payment_method:{card:s,billing_details:{address:{postal_code:y.trim()}}}});if(e)j(e.message||"Payment failed"),d(e.message||"Payment failed");else if(r&&"succeeded"===r.status){console.log("✅ Payment succeeded:",r.id);try{console.log("\uD83D\uDCB3 Confirming payment with backend...");let e=await eu.apiClient.post(`/contracts/${l}/escrow/confirm-payment`,{paymentIntentId:r.id});console.log("✅ Backend confirmed payment:",e),i()}catch(e){console.error("⚠️ Backend confirmation failed, but payment succeeded:",e),i()}}}catch(e){console.error("Payment error:",e),j("An unexpected error occurred"),d("An unexpected error occurred")}finally{h(!1)}};return(0,n.jsxs)(o.Zb,{className:"w-full max-w-md mx-auto",children:[(0,n.jsxs)(o.Ol,{children:[(0,n.jsxs)(o.ll,{className:"flex items-center",children:[n.jsx(W.Z,{className:"h-5 w-5 mr-2"}),"Secure Payment"]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Amount: ",r.toUpperCase()," $",s.toFixed(2)]})]}),(0,n.jsxs)(o.aY,{children:[(0,n.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Information"}),n.jsx("div",{className:"p-4 border border-gray-300 rounded-md",children:n.jsx(B,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}},hidePostalCode:!0}})})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code / ZIP Code"}),n.jsx("input",{id:"postalCode",type:"text",value:y,onChange:e=>g(e.target.value.toUpperCase()),placeholder:"e.g., M5V 3A8 or 12345",className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your Canadian postal code (alphanumeric) or US ZIP code"})]}),f&&n.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:f}),(0,n.jsxs)("div",{className:"flex items-center text-xs text-gray-500 mb-4",children:[n.jsx(V.Z,{className:"h-4 w-4 mr-1"}),"Your payment information is secure and encrypted"]}),n.jsx(c.z,{type:"submit",disabled:!m||x,className:"w-full",size:"lg",children:x?(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):`Pay ${r.toUpperCase()} $${s.toFixed(2)}`})]}),(0,n.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:[n.jsx("p",{children:"This payment will be held in escrow until project milestones are completed."}),n.jsx("p",{children:"Powered by Stripe • Your data is protected with bank-level security"})]})]})]})},ep=e=>n.jsx(U,{stripe:ed,children:n.jsx(em,{...e})});var ex=s(59434),eh=s(55593),ef=s(74723),ej=s(74064),ey=s(770),eg=s(24118),eb=s(33261),ev=s(82015),eN=s(44794),ew=s(41156);let eC=ey.Ry({notes:ey.Z_().optional(),confirmPayment:ey.O7().refine(e=>!0===e,"You must confirm the payment")});function eP({contractId:e,isOpen:t,onClose:s,onSuccess:r}){let[l,i]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[p,h]=(0,a.useState)(!1),[b,N]=(0,a.useState)(null),{register:w,handleSubmit:C,formState:{errors:P},setValue:S,watch:E}=(0,ef.cI)({resolver:(0,ej.F)(eC)}),k=E("confirmPayment"),A=async t=>{if(l)try{h(!0),N(null),await eu.apiClient.post(`/contracts/${e}/payments/biweekly`,{periodStart:l.startDate,periodEnd:l.endDate,totalHours:l.totalHours,totalAmount:l.totalAmount,platformFee:l.platformFee,taxAmount:l.taxAmount,netAmount:l.netAmount,timeEntryIds:l.timeEntries.map(e=>e.id),notes:t.notes}),r?.(),s()}catch(e){N(e.response?.data?.message||"Failed to process payment")}finally{h(!1)}},O=()=>{p||s()};return n.jsx(eg.Vq,{open:t,onOpenChange:O,children:(0,n.jsxs)(eg.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,n.jsxs)(eg.fK,{children:[(0,n.jsxs)(eg.$N,{className:"flex items-center gap-2",children:[n.jsx(f.Z,{className:"h-5 w-5"}),"Process Biweekly Payment"]}),n.jsx(eg.Be,{children:"Review and process payment for approved time entries in the current period."})]}),u?n.jsx("div",{className:"space-y-4",children:(0,n.jsxs)("div",{className:"animate-pulse",children:[n.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("div",{className:"h-3 bg-gray-200 rounded"}),n.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"}),n.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):b?(0,n.jsxs)(eb.bZ,{variant:"destructive",children:[n.jsx(j.Z,{className:"h-4 w-4"}),n.jsx(eb.X,{children:b})]}):l?(0,n.jsxs)("form",{onSubmit:C(A),className:"space-y-6",children:[(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:(0,n.jsxs)(o.ll,{className:"flex items-center gap-2",children:[n.jsx(x.Z,{className:"h-5 w-5"}),"Payment Period Summary"]})}),(0,n.jsxs)(o.aY,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,n.jsxs)("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Period"}),(0,n.jsxs)("p",{className:"font-semibold",children:[(0,v.p6)(l.startDate)," - ",(0,v.p6)(l.endDate)]})]}),(0,n.jsxs)("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Hours"}),(0,n.jsxs)("p",{className:"font-semibold flex items-center gap-1",children:[n.jsx(y.Z,{className:"h-4 w-4"}),l.totalHours," hours"]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[n.jsx("p",{className:"text-sm text-blue-600",children:"Gross Amount"}),n.jsx("p",{className:"text-lg font-bold text-blue-700",children:(0,v.xG)(l.totalAmount)})]}),(0,n.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[n.jsx("p",{className:"text-sm text-yellow-600",children:"Platform Fee"}),(0,n.jsxs)("p",{className:"text-lg font-bold text-yellow-700",children:["-",(0,v.xG)(l.platformFee)]})]}),(0,n.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[n.jsx("p",{className:"text-sm text-red-600",children:"Tax Amount"}),(0,n.jsxs)("p",{className:"text-lg font-bold text-red-700",children:["-",(0,v.xG)(l.taxAmount)]})]}),(0,n.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[n.jsx("p",{className:"text-sm text-green-600",children:"Net Payment"}),n.jsx("p",{className:"text-lg font-bold text-green-700",children:(0,v.xG)(l.netAmount)})]})]})]})]}),(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:(0,n.jsxs)(o.ll,{className:"flex items-center gap-2",children:[n.jsx(g.Z,{className:"h-5 w-5"}),"Time Entries (",l.timeEntries.length,")"]})}),n.jsx(o.aY,{children:(0,n.jsxs)(ew.iA,{children:[n.jsx(ew.xD,{children:(0,n.jsxs)(ew.SC,{children:[n.jsx(ew.ss,{children:"Date"}),n.jsx(ew.ss,{children:"Hours"}),n.jsx(ew.ss,{children:"Status"}),n.jsx(ew.ss,{children:"Description"}),n.jsx(ew.ss,{className:"text-right",children:"Amount"})]})}),n.jsx(ew.RM,{children:l.timeEntries.map(e=>(0,n.jsxs)(ew.SC,{children:[n.jsx(ew.pj,{children:(0,v.p6)(e.date)}),(0,n.jsxs)(ew.pj,{className:"font-mono",children:[e.hours,"h"]}),n.jsx(ew.pj,{children:n.jsx(d.C,{variant:"secondary",children:e.status})}),n.jsx(ew.pj,{className:"max-w-xs",children:n.jsx("p",{className:"truncate",title:e.description,children:e.description})}),n.jsx(ew.pj,{className:"text-right font-semibold",children:(0,v.xG)(e.amount)})]},e.id))})]})})]}),(0,n.jsxs)("div",{children:[n.jsx(eN._,{htmlFor:"notes",children:"Payment Notes (Optional)"}),n.jsx(ev.g,{id:"notes",...w("notes"),placeholder:"Add any notes about this payment...",rows:3})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[n.jsx("input",{type:"checkbox",id:"confirmPayment",...w("confirmPayment"),className:"rounded border-gray-300"}),(0,n.jsxs)(eN._,{htmlFor:"confirmPayment",className:"text-sm",children:["I confirm that I want to process this payment of"," ",n.jsx("span",{className:"font-semibold",children:l&&(0,v.xG)(l.netAmount)})," ","to the talent."]})]}),P.confirmPayment&&n.jsx("p",{className:"text-sm text-red-600",children:P.confirmPayment.message}),(0,n.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[n.jsx(c.z,{type:"submit",disabled:p||!k,className:"flex-1",children:p?"Processing Payment...":"Process Payment"}),n.jsx(c.z,{type:"button",variant:"outline",onClick:O,disabled:p,children:"Cancel"})]})]}):(0,n.jsxs)(eb.bZ,{children:[n.jsx(j.Z,{className:"h-4 w-4"}),n.jsx(eb.X,{children:"No approved time entries found for the current payment period."})]})]})})}var eS=s(38518);let eE=[{code:"AB",name:"Alberta"},{code:"BC",name:"British Columbia"},{code:"MB",name:"Manitoba"},{code:"NB",name:"New Brunswick"},{code:"NL",name:"Newfoundland and Labrador"},{code:"NT",name:"Northwest Territories"},{code:"NS",name:"Nova Scotia"},{code:"NU",name:"Nunavut"},{code:"ON",name:"Ontario"},{code:"PE",name:"Prince Edward Island"},{code:"QC",name:"Quebec"},{code:"SK",name:"Saskatchewan"},{code:"YT",name:"Yukon"}];function ek({isOpen:e,onClose:t,onLocationUpdated:s}){let[r,l]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null),x=async e=>{if(e.preventDefault(),!r){p("Please select a province");return}try{u(!0),p(null),await eu.apiClient.put("/users/location",{province:r,city:i||void 0}),s(),t()}catch(e){console.error("Failed to update location:",e),p(e.response?.data?.message||"Failed to update location")}finally{u(!1)}};return n.jsx(eg.Vq,{open:e,onOpenChange:e=>!e&&t(),children:(0,n.jsxs)(eg.cZ,{className:"sm:max-w-md",children:[(0,n.jsxs)(eg.fK,{children:[(0,n.jsxs)(eg.$N,{className:"flex items-center gap-2",children:[n.jsx(eS.Z,{className:"h-5 w-5"}),"Update Your Location"]}),n.jsx(eg.Be,{children:"Your province is required to calculate accurate taxes for escrow funding. Please update your business location to continue."})]}),(0,n.jsxs)("form",{onSubmit:x,className:"space-y-4 mt-4",children:[(0,n.jsxs)("div",{children:[n.jsx("label",{htmlFor:"province",className:"block text-sm font-medium text-gray-700 mb-1",children:"Province / Territory *"}),(0,n.jsxs)("select",{id:"province",value:r,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select a province..."}),eE.map(e=>n.jsx("option",{value:e.code,children:e.name},e.code))]})]}),(0,n.jsxs)("div",{children:[n.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"City (Optional)"}),n.jsx("input",{id:"city",type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"e.g., Toronto",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),m&&n.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:m}),(0,n.jsxs)("div",{className:"flex gap-3 justify-end pt-4",children:[n.jsx(c.z,{type:"button",variant:"outline",onClick:t,disabled:d,children:"Cancel"}),n.jsx(c.z,{type:"submit",disabled:d||!r,children:d?(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Location"})]})]}),n.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,n.jsxs)("p",{className:"text-xs text-blue-800",children:[n.jsx("strong",{children:"Why is this required?"})," Your province determines the applicable tax rates (GST, HST, PST) for platform fees, ensuring accurate billing and compliance with Canadian tax regulations."]})})]})})}function eA(){let e=(0,l.useParams)(),t=(0,l.useRouter)(),r=e.id;console.log("Contract Detail Page - params:",e),console.log("Contract Detail Page - contractId:",r);let[N,w]=(0,a.useState)(null),[C,P]=(0,a.useState)(!0),[S,E]=(0,a.useState)(null),[k,A]=(0,a.useState)(null),[O,T]=(0,a.useState)(!1),[D,R]=(0,a.useState)(null),[L,_]=(0,a.useState)(null),[I,F]=(0,a.useState)(!1),[Z,Y]=(0,a.useState)(!1),[q,U]=(0,a.useState)(!1),z=async()=>{try{P(!0);let{apiClient:e}=await Promise.resolve().then(s.bind(s,55137)),t=await e.get(`/contracts/${r}`);w(t);try{let t=await e.get(`/contracts/${r}/escrow/status`);console.log("Escrow status loaded:",t),A(t),_(t.breakdown)}catch(e){console.error("Failed to fetch escrow status:",e)}}catch(e){console.error("Failed to fetch contract:",e),E("Failed to load contract details")}finally{P(!1)}},M=e=>{switch(e.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"submitted":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"pending":default:return"bg-gray-100 text-gray-800";case"rejected":return"bg-red-100 text-red-800"}},$=async(e,t,r)=>{if(confirm(`Release payment for milestone "${t}" ($${r})?

This will:
• Transfer funds from escrow to talent's payout account
• Mark milestone as approved and paid
• Enable talent to withdraw funds

Ensure deliverables have been reviewed and approved before proceeding.`))try{let{apiClient:t}=await Promise.resolve().then(s.bind(s,55137)),n=await t.post("/payments/milestone/release",{milestoneId:e});console.log("✅ Milestone payment released:",n),await z(),alert(`Payment of $${r} has been released to the talent's payout account!

They can now withdraw these funds.`)}catch(t){console.error("Error releasing milestone payment:",t);let e=t.response?.data?.error||"Failed to release payment";alert(`${e}

Please ensure:
• Milestone has been submitted by talent
• Talent has set up their payout account`)}},H=()=>{t.push(`/business/messages?talentId=${N?.talent.id}`)},G=async()=>{if(N)try{T(!0);let{apiClient:e}=await Promise.resolve().then(s.bind(s,55137)),t=await e.post(`/contracts/${N.id}/escrow/fund`,{});if(console.log("Stripe Payment Intent created:",t),t.clientSecret&&t.paymentIntentId)R({id:t.paymentIntentId,clientSecret:t.clientSecret,amount:t.amount,currency:"cad"}),_(t.breakdown),F(!0);else throw console.error("Invalid response structure:",t),Error("No payment intent received from server")}catch(e){if(console.error("Failed to create payment intent:",e),e.response?.data?.error==="LOCATION_REQUIRED"||e.response?.data?.requiresLocationUpdate)U(!0);else if(e.response?.data?.error==="ESCROW_ALREADY_FUNDED")alert("This contract's escrow has already been funded.");else if(e.response?.data?.error==="TALENT_PAYOUT_NOT_SETUP"||e.response?.data?.error==="TALENT_PAYOUT_NOT_ACTIVE"||e.response?.data?.requiresTalentStripeSetup){let t=N?.talent?.profile?.displayName||"the talent";alert(`⚠️ Payout Account Required

${e.response?.data?.message}

${t} needs to set up their payout account:
1. Go to their Payments page
2. Complete Stripe Connect setup
3. Connect their bank account

They will receive an email notification with instructions.
Once they complete setup, you can fund the escrow.`)}else alert(e.response?.data?.message||e.message||"Failed to initiate escrow funding")}finally{T(!1)}},B=async()=>{U(!1);try{console.log("\uD83D\uDCCD Location updated, refreshing contract data..."),await z(),console.log("✅ Contract refreshed, retrying escrow funding..."),await G()}catch(e){console.error("Failed to refresh contract or fund escrow after location update:",e),alert('Location updated successfully. Please click "Fund Escrow" again to proceed.')}},W=async()=>{try{F(!1),R(null),_(null),await z(),alert("\uD83C\uDF89 Escrow funded successfully! The talent has been notified and can now start working.")}catch(e){console.error("Failed to refresh contract data:",e)}};return C?n.jsx("div",{className:"flex justify-center items-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):S||!N?n.jsx("div",{className:"flex justify-center items-center h-64",children:(0,n.jsxs)("div",{className:"text-center",children:[n.jsx("p",{className:"text-red-600 mb-4",children:S||"Contract not found"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Contract ID: ",r||"undefined",n.jsx("br",{}),"URL: ","N/A"]}),(0,n.jsxs)("div",{className:"space-x-2",children:[n.jsx(c.z,{onClick:()=>t.back(),children:"Go Back"}),n.jsx(c.z,{variant:"outline",onClick:()=>t.push("/business/contracts"),children:"View All Contracts"})]})]})}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>t.back(),children:[n.jsx(u.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,n.jsxs)("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:N.title}),n.jsx("p",{className:"text-gray-600",children:"Contract Details"})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx(d.C,{className:(e=>{switch(e.toLowerCase()){case"active":return"bg-green-100 text-green-800";case"pending_signatures":return"bg-yellow-100 text-yellow-800";case"draft":default:return"bg-gray-100 text-gray-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";case"disputed":return"bg-orange-100 text-orange-800"}})(N.status),children:N.status.replace("_"," ").toUpperCase()}),(0,n.jsxs)(c.z,{variant:"outline",size:"sm",onClick:H,children:[n.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Messages"]}),"pending_signatures"===N.status&&(0,n.jsxs)(c.z,{size:"sm",onClick:()=>{console.log("Sign contract:",N?.id),alert("Contract signing feature coming soon!")},children:[n.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Sign Contract"]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:n.jsx(o.ll,{children:"Contract Overview"})}),(0,n.jsxs)(o.aY,{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Description"}),n.jsx("p",{className:"text-gray-600",children:N.description})]}),N.scopeOfWork&&(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Scope of Work"}),n.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:N.scopeOfWork})]}),N.deliverables&&(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Deliverables Summary"}),n.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:N.deliverables})]}),N.paymentSchedule&&(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Payment Schedule"}),n.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:N.paymentSchedule})]}),N.duration&&(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Project Duration"}),n.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:N.duration})]}),N.terms&&(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Contract Terms"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:N.terms})})]}),(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Contract Parties"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Business (Client)"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[n.jsx("strong",{children:"Name:"})," ",N.businessName||N.business?.profile?.companyName||N.project?.business?.profile?.companyName||"Business Name"]}),N.businessAddress&&(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[n.jsx("strong",{children:"Address:"})," ",N.businessAddress]})]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Talent (Contractor)"}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[n.jsx("strong",{children:"Name:"})," ",N.talentName||N.talent?.profile&&(`${N.talent.profile.firstName||""} ${N.talent.profile.lastName||""}`.trim()||N.talent.profile.displayName)||"Talent Name"]}),N.talentAddress&&(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[n.jsx("strong",{children:"Address:"})," ",N.talentAddress]})]})]})]})]}),(N.cancellationPolicy||N.intellectualPropertyRights||N.terms)&&(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Legal Terms & Policies"}),(0,n.jsxs)("div",{className:"space-y-3",children:[N.cancellationPolicy&&(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Cancellation Policy"}),n.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:N.cancellationPolicy})]}),N.intellectualPropertyRights&&(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Intellectual Property Rights"}),n.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:N.intellectualPropertyRights})]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Financial Details"}),(0,n.jsxs)("div",{className:"space-y-2",children:[N.project?.type==="HOURLY"?(0,n.jsxs)(n.Fragment,{children:[N.hourlyRate&&(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Hourly Rate:"}),(0,n.jsxs)("span",{className:"font-medium",children:[(0,v.xG)(N.hourlyRate),"/hr"]})]}),N.estimatedHours&&(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Estimated Hours:"}),(0,n.jsxs)("span",{className:"font-medium",children:[N.estimatedHours," hours"]})]}),N.hourlyRate&&N.estimatedHours&&(0,n.jsxs)("div",{className:"flex justify-between border-t pt-2",children:[n.jsx("span",{className:"text-gray-600",children:"Estimated Total:"}),n.jsx("span",{className:"font-medium",children:(0,v.xG)(N.hourlyRate*N.estimatedHours)})]})]}):(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),n.jsx("span",{className:"font-medium",children:(0,v.xG)(N.totalAmount)})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Contract Type:"}),n.jsx("span",{className:"font-medium capitalize",children:N.project?.type==="HOURLY"?"Hourly":"Fixed Price"})]})]})]}),(0,n.jsxs)("div",{children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Timeline"}),(0,n.jsxs)("div",{className:"space-y-2",children:[N.startDate&&(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Start Date:"}),n.jsx("span",{className:"font-medium",children:(0,v.p6)(new Date(N.startDate))})]}),N.completionDate&&(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Completion Date:"}),n.jsx("span",{className:"font-medium",children:(0,v.p6)(new Date(N.completionDate))})]}),N.endDate&&(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"End Date:"}),n.jsx("span",{className:"font-medium",children:(0,v.p6)(new Date(N.endDate))})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Created:"}),n.jsx("span",{className:"font-medium",children:(0,v.p6)(new Date(N.createdAt))})]})]})]})]})]})]}),N.milestones&&N.milestones.length>0&&(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:n.jsx(o.ll,{children:"Project Milestones"})}),n.jsx(o.aY,{children:n.jsx("div",{className:"space-y-4",children:N.milestones.map((e,t)=>(0,n.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("h4",{className:"font-medium text-gray-900",children:[t+1,". ",e.title]}),e.description&&n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx(d.C,{className:M(e.status),variant:"secondary",children:e.status.replace("_"," ")}),n.jsx("span",{className:"font-medium",children:(0,v.xG)(e.amount)})]})]}),e.deliverables&&(0,n.jsxs)("div",{className:"mb-3",children:[n.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Deliverables:"}),n.jsx("p",{className:"text-sm text-gray-600",children:e.deliverables})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.dueDate&&(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[n.jsx(x.Z,{className:"h-4 w-4"}),(0,n.jsxs)("span",{children:["Due: ",(0,v.p6)(new Date(e.dueDate))]})]}),e.percentage&&(0,n.jsxs)("span",{children:[e.percentage,"% of total"]})]}),("ACTIVE"===N.status||"IN_PROGRESS"===N.status)&&(0,n.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[n.jsx(ex.i,{milestoneId:e.id,userRole:"business",canEdit:!1,onUpdate:()=>{console.log("\uD83D\uDD04 Refreshing contract after deliverable update..."),z()}}),(()=>{let s=e.payments&&e.payments.length>0,r=s&&"COMPLETED"===e.payments[0].status,a=e.deliverables||[],l=a.length>0&&a.every(e=>"APPROVED"===e.status),i=a.length>0;console.log(`Milestone ${t+1} status:`,e.status,"Has payment:",s,"Is paid:",r,"Deliverables:",a.length,"All approved:",l);let o="SUBMITTED"===e.status&&(!i||l);return o||r?n.jsx("div",{className:"mt-4 flex justify-end",children:r?(0,n.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[n.jsx(h.Z,{className:"h-5 w-5"}),(0,n.jsxs)("span",{className:"font-medium",children:["Payment Released ($",e.payments[0].amount,")"]})]}):(0,n.jsxs)(c.z,{onClick:()=>$(e.id,e.title,e.amount),disabled:!o,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",title:o?"":i&&!l?"All deliverables must be approved":"Milestone must be submitted",children:["Complete Milestone & Release Payment ($",e.amount,")"]})}):null})()]})]},e.id))})})]}),N.project?.type==="HOURLY"&&("ACTIVE"===N.status||"IN_PROGRESS"===N.status)&&(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[n.jsx(o.ll,{children:"Time Tracking & Payments"}),n.jsx(c.z,{onClick:()=>Y(!0),disabled:!N.hourlyRate,children:"Process Payment"})]})}),n.jsx(o.aY,{children:n.jsx(eh.e,{contractId:r,userRole:"business",canEdit:!1})})]}),(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:n.jsx(o.ll,{children:"Signature Status"})}),n.jsx(o.aY,{children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${N.businessSignedAt?"bg-green-500":"bg-gray-300"}`}),n.jsx("span",{className:"font-medium",children:"Business Signature"})]}),n.jsx("div",{className:"text-sm text-gray-600",children:N.businessSignedAt?(0,n.jsxs)("span",{className:"text-green-600",children:["Signed ",(0,v.SY)(new Date(N.businessSignedAt))]}):n.jsx("span",{children:"Pending"})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-3 h-3 rounded-full ${N.talentSignedAt?"bg-green-500":"bg-gray-300"}`}),n.jsx("span",{className:"font-medium",children:"Talent Signature"})]}),n.jsx("div",{className:"text-sm text-gray-600",children:N.talentSignedAt?(0,n.jsxs)("span",{className:"text-green-600",children:["Signed ",(0,v.SY)(new Date(N.talentSignedAt))]}):n.jsx("span",{children:"Pending"})})]})]})})]}),"ACTIVE"===N.status&&N.businessSignedAt&&N.talentSignedAt&&(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:(0,n.jsxs)(o.ll,{className:"flex items-center",children:[n.jsx(f.Z,{className:"h-5 w-5 mr-2"}),"Escrow Funding"]})}),n.jsx(o.aY,{children:n.jsx("div",{className:"space-y-4",children:k?.needsFunding?(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-start",children:[n.jsx(j.Z,{className:"h-5 w-5 text-yellow-500 mt-0.5 mr-3"}),(0,n.jsxs)("div",{children:[n.jsx("h4",{className:"font-medium text-yellow-800",children:"Escrow Funding Required"}),n.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"To activate this project, you must fund the escrow account with the full contract amount. This ensures secure payment to the talent upon milestone completion."})]})]})}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[n.jsx("span",{className:"font-medium text-gray-900",children:N.project?.type==="HOURLY"?"Estimated Total Amount:":"Total Contract Amount:"}),n.jsx("span",{className:"text-xl font-bold text-gray-900",children:(()=>{let e=N.estimatedHours||N.application?.estimatedHours;return N.project?.type==="HOURLY"&&N.hourlyRate&&e?(0,v.xG)(N.hourlyRate*e):(0,v.xG)(N.totalAmount)})()})]}),(()=>{let e=N.estimatedHours||N.application?.estimatedHours;return N.project?.type==="HOURLY"&&N.hourlyRate&&e&&(0,n.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:["Based on ",e," hours \xd7 ",(0,v.xG)(N.hourlyRate),"/hr"]})})(),(0,n.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["This amount will be held in escrow and released to the talent as ",N.project?.type==="HOURLY"?"time is tracked and approved":"milestones are completed and approved","."]}),n.jsx(c.z,{onClick:G,disabled:O,className:"w-full",size:"lg",children:O?(0,n.jsxs)(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(f.Z,{className:"h-4 w-4 mr-2"}),"Fund Escrow - ",(()=>{let e=N.estimatedHours||N.application?.estimatedHours;return N.project?.type==="HOURLY"&&N.hourlyRate&&e?(0,v.xG)(N.hourlyRate*e):(0,v.xG)(N.totalAmount)})()]})})]}),I&&D&&(0,n.jsxs)("div",{className:"mt-6",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Complete Payment"}),L&&(0,n.jsxs)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Payment Breakdown"}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Project Amount:"}),n.jsx("span",{className:"font-medium",children:(0,v.xG)(L.escrowAmount)})]}),L.platformFee&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Platform Fee:"}),n.jsx("span",{className:"font-medium",children:(0,v.xG)(L.platformFee.baseFee)})]}),L.platformFee.taxAmount>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Tax:"}),n.jsx("span",{className:"font-medium",children:(0,v.xG)(L.platformFee.taxAmount)})]}),n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:L.platformFee.description})]}),(0,n.jsxs)("div",{className:"border-t border-blue-300 pt-2 mt-2 flex justify-between font-semibold text-base",children:[n.jsx("span",{className:"text-gray-900",children:"Total Amount:"}),n.jsx("span",{className:"text-blue-600",children:(0,v.xG)(L.totalAmount)})]})]}),L.chargeDescription&&n.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:n.jsx("p",{className:"text-xs text-gray-600",children:L.chargeDescription})})]}),n.jsx(ep,{paymentIntentId:D.id,clientSecret:D.clientSecret,amount:D.amount,currency:D.currency,contractId:N.id,onSuccess:W,onError:e=>{console.error("Payment failed:",e),alert(`Payment failed: ${e}`),F(!1),R(null)}}),n.jsx("div",{className:"mt-4 text-center",children:n.jsx(c.z,{variant:"outline",onClick:()=>{F(!1),R(null),_(null)},children:"Cancel Payment"})})]})]}):k?.canStartProject?n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-start",children:[n.jsx(h.Z,{className:"h-5 w-5 text-green-500 mt-0.5 mr-3"}),(0,n.jsxs)("div",{children:[n.jsx("h4",{className:"font-medium text-green-800",children:"Escrow Funded Successfully"}),(0,n.jsxs)("p",{className:"text-sm text-green-700 mt-1",children:["The escrow account has been funded with ",(0,v.xG)(k.escrowAccount?.totalAmount?Number(k.escrowAccount.totalAmount):Number(N.totalAmount)),". The talent has been notified and can now start working on the project."]}),k.escrowAccount?.fundedAt&&(0,n.jsxs)("p",{className:"text-xs text-green-600 mt-2",children:["Funded: ",(0,v.SY)(new Date(k.escrowAccount.fundedAt))]})]})]})}):n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,n.jsxs)("div",{className:"flex items-start",children:[n.jsx(y.Z,{className:"h-5 w-5 text-blue-500 mt-0.5 mr-3"}),(0,n.jsxs)("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800",children:"Escrow Processing"}),n.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Escrow funding is being processed. This may take a few minutes to complete."})]})]})})})})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:n.jsx(o.ll,{children:"Project"})}),n.jsx(o.aY,{children:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:N.project.title}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.project.description})]}),n.jsx(c.z,{variant:"outline",size:"sm",asChild:!0,className:"w-full",children:(0,n.jsxs)(i.default,{href:`/business/projects/${N.project.id}`,children:[n.jsx(g.Z,{className:"h-4 w-4 mr-2"}),"View Project"]})})]})})]}),(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:n.jsx(o.ll,{children:"Talent"})}),n.jsx(o.aY,{children:(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[N.talent.profile.avatar?n.jsx("img",{src:N.talent.profile.avatar,alt:N.talent.profile.displayName,className:"w-10 h-10 rounded-full"}):n.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:n.jsx(b.Z,{className:"h-5 w-5 text-gray-500"})}),(0,n.jsxs)("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:N.talent.profile.displayName}),N.talent.profile.title&&n.jsx("p",{className:"text-sm text-gray-600",children:N.talent.profile.title})]})]}),n.jsx(c.z,{variant:"outline",size:"sm",asChild:!0,className:"w-full",children:(0,n.jsxs)(i.default,{href:`/business/talent/${N.talent.id}`,children:[n.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"View Profile"]})})]})})]}),(0,n.jsxs)(o.Zb,{children:[n.jsx(o.Ol,{children:n.jsx(o.ll,{children:"Quick Actions"})}),n.jsx(o.aY,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)(c.z,{variant:"outline",size:"sm",className:"w-full",onClick:H,children:[n.jsx(m.Z,{className:"h-4 w-4 mr-2"}),"Send Message"]}),(0,n.jsxs)(c.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{console.log("Download contract:",N?.id),alert("Contract download feature coming soon!")},children:[n.jsx(g.Z,{className:"h-4 w-4 mr-2"}),"Download Contract"]}),"active"===N.status&&(0,n.jsxs)(c.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{t.push(`/business/contracts/${N?.id}/edit`)},children:[n.jsx(p.Z,{className:"h-4 w-4 mr-2"}),"Modify Contract"]})]})})]})]})]}),n.jsx(eP,{contractId:r,isOpen:Z,onClose:()=>Y(!1),onSuccess:()=>{Y(!1),z()}}),n.jsx(ek,{isOpen:q,onClose:()=>U(!1),onLocationUpdated:B})]})}},95375:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`C:\Users\totur\OneDrive\Documents\Wennovate Consulting\Internal Projects\LocalTalents_ca\LocalTalent-app\src\app\(dashboard)\business\contracts\[id]\page.tsx#default`)},14526:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(17577);let n=r.forwardRef(function({title:e,titleId:t,...s},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},99733:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(17577);let n=r.forwardRef(function({title:e,titleId:t,...s},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))})},38518:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(17577);let n=r.forwardRef(function({title:e,titleId:t,...s},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))})},41217:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var r=s(17577);let n=r.forwardRef(function({title:e,titleId:t,...s},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},s),e?r.createElement("title",{id:t},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8249,280,2325,9581,9642,4254,52,5148,5227,4759,4281,7004],()=>s(54030));module.exports=r})();