"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7200],{20774:function(e,s,a){a.d(s,{m:function(){return E}});var t=a(57437),l=a(2265),i=a(79820),n=a(12381),r=a(40279),c=a(69174),d=a(68245),o=a(32060),m=a(95937),x=a(10588),u=a(31071),h=a(61601),p=a(41556),j=a(94565),f=a(87626),g=a(20322),v=a(65001),N=a(42548),y=a(46217),w=a(40178),b=a(71080),C=a(50390),D=a(93448),k=a(74291),z=a(19967),Z=a(89833),S=a(36072);function F(e){let{file:s,onClose:a}=e,{data:l}=(0,C.lI)(s.id),{download:i}=(0,C.Rr)(),r=async()=>{try{await i(s.id)}catch(e){console.error("Download failed:",e)}},d=()=>s.mimeType.startsWith("image/")?(0,t.jsx)(z.Z,{className:"w-8 h-8 text-blue-500"}):s.mimeType.startsWith("video/")?(0,t.jsx)(Z.Z,{className:"w-8 h-8 text-purple-500"}):s.mimeType.startsWith("audio/")?(0,t.jsx)(S.Z,{className:"w-8 h-8 text-green-500"}):(0,t.jsx)(f.Z,{className:"w-8 h-8 text-gray-500"});return(0,t.jsx)(k.Vq,{open:!0,onOpenChange:a,children:(0,t.jsxs)(k.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(k.fK,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(k.$N,{className:"flex items-center gap-3",children:[d(),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold",children:s.originalName}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(s.fileSize/1024/1024).toFixed(2)," MB • ",s.mimeType]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(n.z,{variant:"outline",size:"sm",onClick:r,children:[(0,t.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Download"]}),(0,t.jsxs)(n.z,{variant:"outline",size:"sm",children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Share"]})]})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"border rounded-lg p-4",children:(()=>{if(!(null==l?void 0:l.canPreview))return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 bg-gray-50 rounded-lg",children:[d(),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Preview not available for this file type"}),(0,t.jsxs)(n.z,{onClick:r,className:"mt-4",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4 mr-2"}),"Download to View"]})]});switch(l.previewType){case"image":return(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("img",{src:l.previewUrl,alt:s.originalName,className:"max-w-full max-h-96 object-contain rounded-lg"})});case"video":return(0,t.jsx)("video",{src:l.previewUrl,controls:!0,className:"w-full max-h-96 rounded-lg",children:"Your browser does not support the video tag."});case"pdf":return(0,t.jsx)("iframe",{src:l.previewUrl,className:"w-full h-96 rounded-lg border",title:s.originalName});case"text":return(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg h-64 overflow-auto",children:(0,t.jsx)("pre",{className:"text-sm whitespace-pre-wrap",children:l.previewUrl})});default:return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 bg-gray-50 rounded-lg",children:[d(),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Preview not available"})]})}})()}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"File Information"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"File Name:"}),(0,t.jsx)("span",{className:"font-medium",children:s.originalName})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"File Size:"}),(0,t.jsxs)("span",{className:"font-medium",children:[(s.fileSize/1024/1024).toFixed(2)," MB"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"File Type:"}),(0,t.jsx)("span",{className:"font-medium",children:s.mimeType})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Category:"}),(0,t.jsx)(c.C,{variant:"secondary",children:s.category})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Uploaded:"}),(0,t.jsx)("span",{className:"font-medium",children:(0,D.p6)(s.uploadedAt)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Access Level:"}),(0,t.jsx)(c.C,{variant:"outline",children:s.accessLevel.replace("_"," ")})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Additional Details"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[s.metadata.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600 block mb-1",children:"Description:"}),(0,t.jsx)("p",{className:"text-gray-900",children:s.metadata.description})]}),s.metadata.tags.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-600 block mb-2",children:"Tags:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:s.metadata.tags.map(e=>(0,t.jsx)(c.C,{variant:"secondary",className:"text-xs",children:e},e))})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Downloads:"}),(0,t.jsx)("span",{className:"font-medium",children:s.downloadCount||0})]}),s.virusScanStatus&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Virus Scan:"}),(0,t.jsx)(c.C,{variant:"clean"===s.virusScanStatus?"default":"destructive",className:"text-xs",children:s.virusScanStatus})]})]})]})]}),s.versions&&s.versions.length>0&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Version History"}),(0,t.jsx)("div",{className:"space-y-2",children:s.versions.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-medium",children:["Version ",s.versions.length-a]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,D.p6)(e.createdAt)," • ",(e.fileSize/1024/1024).toFixed(2)," MB"]}),e.changeNotes&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.changeNotes})]}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",children:"Download"})]},e.id))})]})]})]})})}var I=a(29501),P=a(13590),A=a(67119),_=a(75060),L=a(15291),B=a(87233),U=a(1345),T=a(47842);let M=A.Ry({expiresIn:A.Rx().min(1).max(365),maxAccesses:A.Rx().min(1).max(1e3).optional(),password:A.Z_().optional(),allowDownload:A.O7().default(!0),allowPreview:A.O7().default(!0)});function q(e){var s;let{file:a,onClose:i}=e,[c,o]=(0,l.useState)(null),[x,u]=(0,l.useState)(!1),h=(0,C.Ze)(),{register:p,handleSubmit:j,watch:f,setValue:g,formState:{errors:v}}=(0,I.cI)({resolver:(0,P.F)(M),defaultValues:{expiresIn:7,allowDownload:!0,allowPreview:!0}}),w=f(),D=async e=>{try{let s=await h.mutateAsync({fileId:a.id,options:e});o(s.shareUrl||null)}catch(e){console.error("Failed to create share link:",e)}},z=async()=>{c&&(await navigator.clipboard.writeText(c),u(!0),setTimeout(()=>u(!1),2e3))};return c?(0,t.jsx)(k.Vq,{open:!0,onOpenChange:i,children:(0,t.jsxs)(k.cZ,{className:"max-w-md",children:[(0,t.jsx)(k.fK,{children:(0,t.jsxs)(k.$N,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"w-5 h-5"}),"Share Link Created"]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(m.bZ,{className:"border-green-200 bg-green-50",children:[(0,t.jsx)(B.Z,{className:"w-4 h-4 text-green-600"}),(0,t.jsx)(m.X,{className:"text-green-800",children:"Share link has been created successfully!"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(_._,{children:"Share Link"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r.I,{value:c,readOnly:!0,className:"font-mono text-sm"}),(0,t.jsx)(n.z,{variant:"outline",size:"sm",onClick:z,className:"shrink-0",children:x?(0,t.jsx)(B.Z,{className:"w-4 h-4"}):(0,t.jsx)(U.Z,{className:"w-4 h-4"})})]}),x&&(0,t.jsx)("p",{className:"text-sm text-green-600",children:"Link copied to clipboard!"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[(0,t.jsx)("h4",{className:"font-medium",children:"Link Settings:"}),(0,t.jsxs)("ul",{className:"space-y-1 text-gray-600",children:[(0,t.jsxs)("li",{children:["• Expires in ",w.expiresIn," day",1!==w.expiresIn?"s":""]}),w.maxAccesses&&(0,t.jsxs)("li",{children:["• Maximum ",w.maxAccesses," access",1!==w.maxAccesses?"es":""]}),w.password&&(0,t.jsx)("li",{children:"• Password protected"}),(0,t.jsxs)("li",{children:["• Download ",w.allowDownload?"allowed":"disabled"]}),(0,t.jsxs)("li",{children:["• Preview ",w.allowPreview?"allowed":"disabled"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(n.z,{variant:"outline",onClick:i,children:"Close"}),(0,t.jsxs)(n.z,{onClick:z,children:[(0,t.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]})]})}):(0,t.jsx)(k.Vq,{open:!0,onOpenChange:i,children:(0,t.jsxs)(k.cZ,{className:"max-w-md",children:[(0,t.jsx)(k.fK,{children:(0,t.jsxs)(k.$N,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"w-5 h-5"}),"Create Share Link"]})}),(0,t.jsxs)("form",{onSubmit:j(D),className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-gray-50 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)(b.Z,{className:"w-5 h-5 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm",children:a.originalName}),(0,t.jsxs)("p",{className:"text-xs text-gray-600",children:[(a.fileSize/1024/1024).toFixed(2)," MB"]})]})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_._,{htmlFor:"expiresIn",children:"Link Expiration"}),(0,t.jsxs)(L.Ph,{value:null===(s=w.expiresIn)||void 0===s?void 0:s.toString(),onValueChange:e=>g("expiresIn",parseInt(e)),children:[(0,t.jsx)(L.i4,{children:(0,t.jsx)(L.ki,{placeholder:"Select expiration"})}),(0,t.jsx)(L.Bw,{children:[{value:1,label:"1 day"},{value:3,label:"3 days"},{value:7,label:"1 week"},{value:14,label:"2 weeks"},{value:30,label:"1 month"},{value:90,label:"3 months"},{value:365,label:"1 year"}].map(e=>(0,t.jsx)(L.Ql,{value:e.value.toString(),children:e.label},e.value))})]}),v.expiresIn&&(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:v.expiresIn.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_._,{htmlFor:"maxAccesses",children:"Maximum Access Count (Optional)"}),(0,t.jsx)(r.I,{...p("maxAccesses",{valueAsNumber:!0}),type:"number",placeholder:"Unlimited",min:"1",max:"1000"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Leave empty for unlimited access"}),v.maxAccesses&&(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:v.maxAccesses.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_._,{htmlFor:"password",children:"Password Protection (Optional)"}),(0,t.jsx)(r.I,{...p("password"),type:"password",placeholder:"Enter password"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Add a password to restrict access"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(_._,{children:"Permissions"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.X,{id:"allowPreview",checked:w.allowPreview,onCheckedChange:e=>g("allowPreview",e)}),(0,t.jsxs)(_._,{htmlFor:"allowPreview",className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(N.Z,{className:"w-4 h-4"}),"Allow preview"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.X,{id:"allowDownload",checked:w.allowDownload,onCheckedChange:e=>g("allowDownload",e)}),(0,t.jsxs)(_._,{htmlFor:"allowDownload",className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(y.Z,{className:"w-4 h-4"}),"Allow download"]})]})]})]}),(0,t.jsxs)(m.bZ,{className:"border-blue-200 bg-blue-50",children:[(0,t.jsx)(T.Z,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)(m.X,{className:"text-blue-800",children:"Anyone with this link will be able to access the file according to the permissions you set."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,t.jsx)(n.z,{type:"button",variant:"outline",onClick:i,children:"Cancel"}),(0,t.jsx)(n.z,{type:"submit",disabled:h.isPending,children:h.isPending?"Creating Link...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Create Share Link"]})})]})]})]})})}function E(e){var s;let{projectId:a,conversationId:c,applicationId:g,contractId:v,escrowId:N,milestoneId:y,showUpload:w=!0,allowBulkOperations:b=!0,viewMode:D="grid",className:k}=e,[z,Z]=(0,l.useState)(""),[S,I]=(0,l.useState)([]),[P,A]=(0,l.useState)(D),[_,L]=(0,l.useState)("all"),[B,U]=(0,l.useState)(null),[T,M]=(0,l.useState)(null),{data:E=[],isLoading:K,error:V}=(0,C.Yg)({projectId:a,conversationId:c,applicationId:g,contractId:v,escrowId:N,milestoneId:y}),{download:X}=(0,C.Rr)(),W=(0,C.BU)();(0,C.Ze)();let{formatFileSize:Y,getFileIcon:Q,isPreviewable:$}=(0,C.MZ)(),{bulkDelete:G}=(0,C.LO)(),H=E.filter(e=>{var s;let a=e.originalName.toLowerCase().includes(z.toLowerCase())||(null===(s=e.metadata.description)||void 0===s?void 0:s.toLowerCase().includes(z.toLowerCase()))||e.metadata.tags.some(e=>e.toLowerCase().includes(z.toLowerCase())),t="all"===_||e.category===_;return a&&t}),J=(e,s)=>{s?I(s=>[...s,e]):I(s=>s.filter(s=>s!==e))},ee=async()=>{if(0!==S.length)try{await G(S),I([])}catch(e){console.error("Bulk delete failed:",e)}},es=async e=>{try{await X(e.id)}catch(e){console.error("Download failed:",e)}},ea=async e=>{try{await W.mutateAsync(e.id)}catch(e){console.error("Delete failed:",e)}},et=async e=>{M(e)},el=[{value:"all",label:"All Files"},{value:"document",label:"Documents"},{value:"image",label:"Images"},{value:"video",label:"Videos"},{value:"audio",label:"Audio"},{value:"archive",label:"Archives"},{value:"code",label:"Code"},{value:"design",label:"Design"},{value:"other",label:"Other"}];return K?(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading files..."})]})}):V?(0,t.jsx)(m.bZ,{className:"border-red-200 bg-red-50",children:(0,t.jsx)(m.X,{className:"text-red-800",children:"Failed to load files. Please try again."})}):(0,t.jsxs)("div",{className:k,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Files"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[H.length," file",1!==H.length?"s":"",E.length!==H.length&&" (".concat(E.length," total)")]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center border rounded-lg",children:[(0,t.jsx)(n.z,{variant:"grid"===P?"default":"ghost",size:"sm",onClick:()=>A("grid"),className:"rounded-r-none",children:(0,t.jsx)(x.Z,{className:"w-4 h-4"})}),(0,t.jsx)(n.z,{variant:"list"===P?"default":"ghost",size:"sm",onClick:()=>A("list"),className:"rounded-l-none",children:(0,t.jsx)(u.Z,{className:"w-4 h-4"})})]}),b&&S.length>0&&(0,t.jsxs)(n.z,{variant:"destructive",size:"sm",onClick:ee,children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Delete (",S.length,")"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,t.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,t.jsx)(r.I,{placeholder:"Search files...",value:z,onChange:e=>Z(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(o.h_,{children:[(0,t.jsx)(o.$F,{asChild:!0,children:(0,t.jsxs)(n.z,{variant:"outline",size:"sm",children:[(0,t.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),null===(s=el.find(e=>e.value===_))||void 0===s?void 0:s.label]})}),(0,t.jsx)(o.AW,{children:el.map(e=>(0,t.jsx)(o.Xi,{onClick:()=>L(e.value),children:e.label},e.value))})]})]}),b&&H.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)(d.X,{checked:S.length===H.length&&H.length>0,onCheckedChange:e=>{e?I(H.map(e=>e.id)):I([])}}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Select all (",H.length," files)"]})]}),0===H.length?(0,t.jsx)(i.Zb,{children:(0,t.jsxs)(i.aY,{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(f.Z,{className:"w-12 h-12 text-gray-400 mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No files found"}),(0,t.jsx)("p",{className:"text-gray-600 text-center",children:z||"all"!==_?"Try adjusting your search or filters":"Upload some files to get started"})]})}):"grid"===P?(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:H.map(e=>(0,t.jsx)(R,{file:e,selected:S.includes(e.id),onSelect:b?s=>J(e.id,s):void 0,onPreview:()=>U(e),onDownload:()=>es(e),onShare:()=>et(e),onDelete:()=>ea(e),formatFileSize:Y,getFileIcon:Q,isPreviewable:$},e.id))}):(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"p-0",children:(0,t.jsx)("div",{className:"divide-y",children:H.map(e=>(0,t.jsx)(O,{file:e,selected:S.includes(e.id),onSelect:b?s=>J(e.id,s):void 0,onPreview:()=>U(e),onDownload:()=>es(e),onShare:()=>et(e),onDelete:()=>ea(e),formatFileSize:Y,getFileIcon:Q,isPreviewable:$},e.id))})})}),B&&(0,t.jsx)(F,{file:B,onClose:()=>U(null)}),T&&(0,t.jsx)(q,{file:T,onClose:()=>M(null)})]})}function R(e){let{file:s,selected:a,onSelect:l,onPreview:r,onDownload:m,onShare:x,onDelete:u,formatFileSize:p,getFileIcon:j,isPreviewable:f}=e;return(0,t.jsx)(i.Zb,{className:"group hover:shadow-md transition-shadow",children:(0,t.jsxs)(i.aY,{className:"p-4",children:[l&&(0,t.jsx)("div",{className:"flex justify-end mb-2",children:(0,t.jsx)(d.X,{checked:a,onCheckedChange:l})}),(0,t.jsx)("div",{className:"flex items-center justify-center h-16 mb-3",children:s.thumbnailUrl?(0,t.jsx)("img",{src:s.thumbnailUrl,alt:s.originalName,className:"max-h-16 max-w-full object-contain rounded"}):(0,t.jsx)("span",{className:"text-4xl",children:j(s.mimeType)})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"font-medium text-sm truncate",title:s.originalName,children:s.originalName}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,t.jsx)("span",{children:p(s.fileSize)}),(0,t.jsx)(c.C,{variant:"secondary",className:"text-xs",children:s.category})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,t.jsx)(g.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:(0,D.p6)(s.uploadedAt)})]}),s.metadata.tags.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,t.jsx)(v.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:s.metadata.tags.join(", ")})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-4 pt-3 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[f(s.mimeType)&&(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:r,children:(0,t.jsx)(N.Z,{className:"w-4 h-4"})}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:m,children:(0,t.jsx)(y.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)(o.h_,{children:[(0,t.jsx)(o.$F,{asChild:!0,children:(0,t.jsx)(n.z,{variant:"ghost",size:"sm",children:(0,t.jsx)(w.Z,{className:"w-4 h-4"})})}),(0,t.jsxs)(o.AW,{children:[(0,t.jsxs)(o.Xi,{onClick:x,children:[(0,t.jsx)(b.Z,{className:"w-4 h-4 mr-2"}),"Share"]}),(0,t.jsx)(o.VD,{}),(0,t.jsxs)(o.Xi,{onClick:u,className:"text-red-600",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]})]})})}function O(e){let{file:s,selected:a,onSelect:l,onPreview:i,onDownload:r,onShare:o,onDelete:m,formatFileSize:x,getFileIcon:u,isPreviewable:p}=e;return(0,t.jsxs)("div",{className:"flex items-center gap-4 p-4 hover:bg-gray-50",children:[l&&(0,t.jsx)(d.X,{checked:a,onCheckedChange:l}),(0,t.jsx)("div",{className:"flex-shrink-0",children:s.thumbnailUrl?(0,t.jsx)("img",{src:s.thumbnailUrl,alt:s.originalName,className:"w-10 h-10 object-cover rounded"}):(0,t.jsx)("span",{className:"text-2xl",children:u(s.mimeType)})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium truncate",children:s.originalName}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-1",children:[(0,t.jsx)("span",{children:x(s.fileSize)}),(0,t.jsx)(c.C,{variant:"secondary",className:"text-xs",children:s.category}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(g.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:(0,D.p6)(s.uploadedAt)})]}),s.metadata.tags.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(v.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"truncate",children:s.metadata.tags.slice(0,2).join(", ")}),s.metadata.tags.length>2&&(0,t.jsxs)("span",{children:["+",s.metadata.tags.length-2]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[p(s.mimeType)&&(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:i,children:(0,t.jsx)(N.Z,{className:"w-4 h-4"})}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:r,children:(0,t.jsx)(y.Z,{className:"w-4 h-4"})}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:o,children:(0,t.jsx)(b.Z,{className:"w-4 h-4"})}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:m,children:(0,t.jsx)(h.Z,{className:"w-4 h-4"})})]})]})}},50042:function(e,s,a){a.d(s,{p:function(){return y}});var t=a(57437),l=a(2265),i=a(79820),n=a(12381),r=a(40279),c=a(23675),d=a(75060),o=a(69174),m=a(7204),x=a(95937),u=a(17653),h=a(30036),p=a(43836),j=a(1442),f=a(47842),g=a(77165),v=a(50390),N=a(93448);function y(e){let{projectId:s,conversationId:a,messageId:y,applicationId:w,contractId:b,escrowId:C,milestoneId:D,category:k,accessLevel:z="project_members",maxFiles:Z=10,maxSize:S=104857600,acceptedTypes:F=["image/*","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","video/mp4","video/webm"],onFilesUploaded:I,className:P}=e,[A,_]=(0,l.useState)([]),[L,B]=(0,l.useState)(!1),U=(0,l.useRef)(null),{upload:T,isUploading:M,uploadProgress:q}=(0,v.FL)(),{formatFileSize:E,getFileIcon:R,isPreviewable:O}=(0,v.MZ)(),{isDragOver:K,dragHandlers:V}=(0,v.Fd)({onFilesDropped:X,acceptedTypes:F,maxFiles:Z,maxSize:S});function X(e){let s=e.map(e=>({...e,id:"".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),status:"pending"}));_(e=>[...e,...s].slice(0,Z))}function W(e,s){_(a=>a.map(a=>a.id===e?{...a,...s}:a))}async function Y(){for(let e of A.filter(e=>"pending"===e.status))try{W(e.id,{status:"uploading",progress:0});let t=await T({file:e,options:{projectId:s,conversationId:a,messageId:y,applicationId:w,contractId:b,escrowId:C,milestoneId:D,category:k,accessLevel:z,description:e.description,tags:e.tags}});W(e.id,{status:"completed",progress:100,uploadedFile:t})}catch(s){W(e.id,{status:"error",error:s instanceof Error?s.message:"Upload failed"})}let e=A.filter(e=>"completed"===e.status&&e.uploadedFile).map(e=>e.uploadedFile);e.length>0&&I&&I(e)}let Q=A.length>0,$=A.some(e=>"pending"===e.status),G=A.some(e=>"completed"===e.status),H=A.reduce((e,s)=>e+s.size,0);return(0,t.jsxs)("div",{className:(0,N.cn)("space-y-4",P),children:[(0,t.jsx)(i.Zb,{className:(0,N.cn)("border-2 border-dashed transition-colors cursor-pointer",K?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400",Q&&"border-solid border-gray-200"),...V,onClick:()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.click()},children:(0,t.jsxs)(i.aY,{className:"flex flex-col items-center justify-center py-8",children:[(0,t.jsx)("input",{ref:U,type:"file",multiple:!0,accept:F.join(","),onChange:function(e){X(Array.from(e.target.files||[])),U.current&&(U.current.value="")},className:"hidden"}),Q?(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"w-5 h-5 text-gray-600"}),(0,t.jsxs)("span",{className:"font-medium",children:[A.length," file",1!==A.length?"s":""," selected"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["(",E(H),")"]})]}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),B(!L)},children:L?"Hide Details":"Show Details"})]}),!L&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)(n.z,{variant:"outline",onClick:e=>{var s;e.stopPropagation(),null===(s=U.current)||void 0===s||s.click()},children:[(0,t.jsx)(p.Z,{className:"w-4 h-4 mr-2"}),"Add More Files"]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{className:"w-12 h-12 text-gray-400 mb-4"}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drop files here or click to browse"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Support for ",F.length>3?"multiple file types":F.join(", ")]}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-4 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Max ",Z," files"]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Up to ",E(S)," each"]})]})]})]})]})}),Q&&L&&(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-4",children:A.map(e=>{var s;return(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,t.jsx)("span",{className:"text-2xl",children:R(e.type)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium truncate",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)("span",{children:E(e.size)}),(0,t.jsx)("span",{children:"•"}),(0,t.jsx)("span",{children:e.type}),O(e.type)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"•"}),(0,t.jsx)(o.C,{variant:"secondary",className:"text-xs",children:"Previewable"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["pending"===e.status&&(0,t.jsx)(o.C,{variant:"secondary",children:"Pending"}),"uploading"===e.status&&(0,t.jsx)(o.C,{variant:"secondary",children:"Uploading..."}),"completed"===e.status&&(0,t.jsxs)(o.C,{variant:"default",className:"bg-green-100 text-green-800",children:[(0,t.jsx)(j.Z,{className:"w-3 h-3 mr-1"}),"Uploaded"]}),"error"===e.status&&(0,t.jsxs)(o.C,{variant:"destructive",children:[(0,t.jsx)(f.Z,{className:"w-3 h-3 mr-1"}),"Error"]}),(0,t.jsx)(n.z,{variant:"ghost",size:"sm",onClick:()=>{var s;return s=e.id,void _(e=>e.filter(e=>e.id!==s))},disabled:"uploading"===e.status,children:(0,t.jsx)(g.Z,{className:"w-4 h-4"})})]})]}),"uploading"===e.status&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)(m.E,{value:q[e.id]||0,className:"h-2"})}),"error"===e.status&&e.error&&(0,t.jsxs)(x.bZ,{className:"border-red-200 bg-red-50 mb-3",children:[(0,t.jsx)(f.Z,{className:"w-4 h-4 text-red-600"}),(0,t.jsx)(x.X,{className:"text-red-800",children:e.error})]}),"pending"===e.status&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d._,{htmlFor:"description-".concat(e.id),className:"text-sm",children:"Description (optional)"}),(0,t.jsx)(c.g,{id:"description-".concat(e.id),placeholder:"Describe this file...",value:e.description||"",onChange:s=>W(e.id,{description:s.target.value}),rows:2,className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(d._,{htmlFor:"tags-".concat(e.id),className:"text-sm",children:"Tags (optional)"}),(0,t.jsx)(r.I,{id:"tags-".concat(e.id),placeholder:"Enter tags separated by commas",value:(null===(s=e.tags)||void 0===s?void 0:s.join(", "))||"",onChange:s=>{let a=s.target.value.split(",").map(e=>e.trim()).filter(Boolean);W(e.id,{tags:a})},className:"mt-1"})]})]})]},e.id)})})})}),Q&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:G&&(0,t.jsx)(n.z,{variant:"outline",onClick:function(){_(e=>e.filter(e=>"completed"!==e.status))},children:"Clear Completed"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.z,{variant:"outline",onClick:()=>_([]),disabled:M,children:"Clear All"}),(0,t.jsxs)(n.z,{onClick:Y,disabled:!$||M,children:[(0,t.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Upload ",A.filter(e=>"pending"===e.status).length," File",1!==A.filter(e=>"pending"===e.status).length?"s":""]})]})]})]})}},7204:function(e,s,a){a.d(s,{E:function(){return r}});var t=a(57437),l=a(2265),i=a(60610),n=a(93448);let r=l.forwardRef((e,s)=>{let{className:a,value:l,...r}=e;return(0,t.jsx)(i.fC,{ref:s,className:(0,n.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...r,children:(0,t.jsx)(i.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});r.displayName=i.fC.displayName},15291:function(e,s,a){a.d(s,{Bw:function(){return p},Ph:function(){return o},Ql:function(){return j},i4:function(){return x},ki:function(){return m}});var t=a(57437),l=a(2265),i=a(33911),n=a(40875),r=a(22135),c=a(30401),d=a(93448);let o=i.fC;i.ZA;let m=i.B4,x=l.forwardRef((e,s)=>{let{className:a,children:l,...r}=e;return(0,t.jsxs)(i.xz,{ref:s,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[l,(0,t.jsx)(i.JO,{asChild:!0,children:(0,t.jsx)(n.Z,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=i.xz.displayName;let u=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.u_,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(r.Z,{className:"h-4 w-4"})})});u.displayName=i.u_.displayName;let h=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.$G,{ref:s,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,t.jsx)(n.Z,{className:"h-4 w-4"})})});h.displayName=i.$G.displayName;let p=l.forwardRef((e,s)=>{let{className:a,children:l,position:n="popper",...r}=e;return(0,t.jsx)(i.h_,{children:(0,t.jsxs)(i.VY,{ref:s,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n,...r,children:[(0,t.jsx)(u,{}),(0,t.jsx)(i.l_,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,t.jsx)(h,{})]})})});p.displayName=i.VY.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...l})}).displayName=i.__.displayName;let j=l.forwardRef((e,s)=>{let{className:a,children:l,...n}=e;return(0,t.jsxs)(i.ck,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(i.wU,{children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(i.eT,{children:l})]})});j.displayName=i.ck.displayName,l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(i.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...l})}).displayName=i.Z0.displayName},3227:function(e,s,a){a.d(s,{x:function(){return t.apiClient}});var t=a(26305)},50390:function(e,s,a){a.d(s,{LO:function(){return b},Ze:function(){return N},BU:function(){return y},Rr:function(){return v},Fd:function(){return C},lI:function(){return w},FL:function(){return f},MZ:function(){return D},Yg:function(){return g}});var t=a(2265),l=a(29827),i=a(21770),n=a(11713);async function r(e){var s,a;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e){if(e.size>104857600)throw Error("File size exceeds maximum allowed size of ".concat(100,"MB"));if(!["image/jpeg","image/png","image/gif","image/webp","image/svg+xml","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain","text/csv","application/json","application/xml","video/mp4","video/webm","video/quicktime","audio/mpeg","audio/wav","audio/ogg","application/zip","application/x-rar-compressed","application/x-7z-compressed"].includes(e.type))throw Error("File type ".concat(e.type," is not allowed"))}(e);let l="file_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i="".concat(l,"_").concat(e.name.replace(/[^a-zA-Z0-9.-]/g,"_").toLowerCase()),n=t.category||((s=e.type).startsWith("image/")?"image":s.startsWith("video/")?"video":s.startsWith("audio/")?"audio":s.includes("pdf")||s.includes("document")||s.includes("text")?"document":s.includes("zip")||s.includes("rar")||s.includes("7z")?"archive":s.includes("javascript")||s.includes("json")||s.includes("xml")?"code":"other"),r={id:l,fileName:i,originalName:e.name,fileSize:e.size,mimeType:e.type,fileUrl:"",uploadedBy:"current_user_id",uploadedAt:new Date,projectId:t.projectId,conversationId:t.conversationId,messageId:t.messageId,applicationId:t.applicationId,contractId:t.contractId,escrowId:t.escrowId,milestoneId:t.milestoneId,category:n,status:"uploading",metadata:{hasPreview:!1,isProcessed:!1,virusScanStatus:"pending",tags:t.tags||[],description:t.description},accessLevel:t.accessLevel||"project_members",downloadCount:0};try{let s=await c(e,i,{contentType:e.type,metadata:{originalName:e.name,uploadedBy:r.uploadedBy,category:n,projectId:t.projectId}});if(r.fileUrl=s.url,r.status="processing","image"===n||"video"===n)try{let a=await d(s.url,e.type);r.thumbnailUrl=a}catch(e){console.warn("Failed to generate thumbnail:",e)}if("image"===n){let s=await o(e);r.metadata.width=s.width,r.metadata.height=s.height}else if("video"===n){let s=await m(e);r.metadata.width=s.width,r.metadata.height=s.height,r.metadata.duration=s.duration}else if("document"===n){let s=await x(e);r.metadata.pages=s.pages}let l=await u(s.url);if(r.metadata.virusScanStatus=l.status,"infected"===l.status)throw r.status="failed",await h(s.url),Error("File failed virus scan");return r.status="ready",r.metadata.isProcessed=!0,r.metadata.hasPreview=(a=e.type,["image/jpeg","image/png","image/gif","image/webp","application/pdf","text/plain","text/csv","video/mp4","video/webm"].includes(a)),await p(r),console.log("File uploaded successfully:",r),r}catch(e){throw r.status="failed",console.error("File upload failed:",e),e}}async function c(e,s,a){return{url:"https://storage.example.com/files/".concat(s)}}async function d(e,s){return"https://storage.example.com/thumbnails/".concat(Date.now(),".jpg")}async function o(e){return{width:1920,height:1080}}async function m(e){return{width:1920,height:1080,duration:120}}async function x(e){return{pages:10}}async function u(e){return{status:"clean"}}async function h(e){console.log("Deleted from cloud storage:",e)}async function p(e){console.log("Saved file record:",e.id)}var j=a(3227);function f(){let e=(0,l.NL)(),[s,a]=(0,t.useState)({}),n=(0,i.D)({mutationFn:async e=>{let{file:s,options:t={}}=e,l="temp_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));a(e=>({...e,[l]:0}));try{let e=setInterval(()=>{a(e=>{let s=e[l]||0;return s<90?{...e,[l]:s+10}:e})},200),i=await r(s,t);return clearInterval(e),a(e=>({...e,[l]:100})),setTimeout(()=>{a(e=>{let{[l]:s,...a}=e;return a})},2e3),{...i,tempId:l}}catch(e){throw a(e=>{let{[l]:s,...a}=e;return a}),e}},onSuccess:(s,a)=>{var t,l,i;(null===(t=a.options)||void 0===t?void 0:t.projectId)&&e.invalidateQueries({queryKey:["files","project",a.options.projectId]}),(null===(l=a.options)||void 0===l?void 0:l.conversationId)&&e.invalidateQueries({queryKey:["files","conversation",a.options.conversationId]}),(null===(i=a.options)||void 0===i?void 0:i.applicationId)&&e.invalidateQueries({queryKey:["files","application",a.options.applicationId]})}});return{upload:n.mutateAsync,isUploading:n.isPending,uploadProgress:s,error:n.error}}function g(e){return(0,n.a)({queryKey:["files",e],queryFn:async()=>(await j.x.get("/files",{params:e})).data,enabled:Object.values(e).some(Boolean)})}function v(){let e=(0,i.D)({mutationFn:async e=>(await j.x.post("/files/".concat(e,"/download"))).data.downloadUrl,onSuccess:e=>{let s=document.createElement("a");s.href=e,s.download="",document.body.appendChild(s),s.click(),document.body.removeChild(s)}});return{download:e.mutateAsync,isDownloading:e.isPending,error:e.error}}function N(){return(0,i.D)({mutationFn:async e=>(await j.x.post("/files/".concat(e.fileId,"/share"),e.options)).data})}function y(){let e=(0,l.NL)();return(0,i.D)({mutationFn:async e=>{await j.x.delete("/files/".concat(e))},onSuccess:(s,a)=>{e.invalidateQueries({queryKey:["files"]}),e.removeQueries({queryKey:["files",a]})}})}function w(e){return(0,n.a)({queryKey:["files",e,"preview"],queryFn:async()=>(await j.x.get("/files/".concat(e,"/preview"))).data,enabled:!!e})}function b(){let e=(0,l.NL)(),s=(0,i.D)({mutationFn:async e=>{await j.x.post("/files/bulk-delete",{fileIds:e})},onSuccess:()=>{e.invalidateQueries({queryKey:["files"]})}}),a=(0,i.D)({mutationFn:async e=>{await j.x.post("/files/bulk-move",e)},onSuccess:()=>{e.invalidateQueries({queryKey:["files"]})}});return{bulkDelete:s.mutateAsync,bulkMove:a.mutateAsync,isBulkDeleting:s.isPending,isBulkMoving:a.isPending}}function C(e){let[s,a]=(0,t.useState)(!1),l=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a(!0)},[]);return{isDragOver:s,dragHandlers:{onDragEnter:l,onDragLeave:(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),a(!1)},[]),onDragOver:(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),onDrop:(0,t.useCallback)(s=>{s.preventDefault(),s.stopPropagation(),a(!1);let t=Array.from(s.dataTransfer.files),l=t;e.acceptedTypes&&(l=t.filter(s=>e.acceptedTypes.some(e=>s.type.match(e)))),e.maxFiles&&l.length>e.maxFiles&&(l=l.slice(0,e.maxFiles)),e.maxSize&&(l=l.filter(s=>s.size<=e.maxSize)),l.length>0&&e.onFilesDropped(l)},[e])}}}function D(){return{formatFileSize:(0,t.useCallback)(e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB"][s]},[]),getFileIcon:(0,t.useCallback)(e=>e.startsWith("image/")?"\uD83D\uDDBC️":e.startsWith("video/")?"\uD83C\uDFA5":e.startsWith("audio/")?"\uD83C\uDFB5":e.includes("pdf")?"\uD83D\uDCC4":e.includes("document")||e.includes("word")?"\uD83D\uDCDD":e.includes("spreadsheet")||e.includes("excel")?"\uD83D\uDCCA":e.includes("presentation")||e.includes("powerpoint")?"\uD83D\uDCC8":e.includes("zip")||e.includes("rar")?"\uD83D\uDDDC️":e.includes("code")||e.includes("javascript")||e.includes("json")?"\uD83D\uDCBB":"\uD83D\uDCC1",[]),isPreviewable:(0,t.useCallback)(e=>["image/jpeg","image/png","image/gif","image/webp","application/pdf","text/plain","text/csv","video/mp4","video/webm"].includes(e),[])}}}}]);