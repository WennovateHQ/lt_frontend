(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8174,6305],{83040:function(e,s,t){Promise.resolve().then(t.bind(t,41108))},41108:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return G}});var a=t(57437),n=t(2265),l=t(99376),r=t(27648),i=t(12381),c=t(79820),d=t(69174),o=t(71924),m=t(43767),x=t(12594),u=t(41077),h=t(1442),p=t(16546),j=t(47842),g=t(20322),y=t(19672),f=t(338),v=t(93448),N=t(74604),b=t(38081),w=t(94675);let P=(0,t(48672).J)("pk_test_51RnblaP5HirIJ0RzmLxLY1UqCYZgYjRPLqFqnO43HS74z6xgbiHcvqVOE1GtOeLY0ZxXDEbA7ji4MWUe2vu7ibgK00rbE04ufW");var C=t(26305);let S=e=>{let{paymentIntentId:s,clientSecret:t,amount:l,currency:r,contractId:d,onSuccess:o,onError:m}=e,x=(0,N.MD)(),u=(0,N.lq)(),[h,p]=(0,n.useState)(!1),[j,g]=(0,n.useState)(null),[y,f]=(0,n.useState)(""),v=async e=>{if(e.preventDefault(),!x||!u)return;if(!y||y.trim().length<3){g("Please enter a valid postal code");return}p(!0),g(null);let s=u.getElement(N.NZ);if(!s){g("Card element not found"),p(!1);return}try{let{error:e,paymentIntent:a}=await x.confirmCardPayment(t,{payment_method:{card:s,billing_details:{address:{postal_code:y.trim()}}}});if(e)g(e.message||"Payment failed"),m(e.message||"Payment failed");else if(a&&"succeeded"===a.status){console.log("✅ Payment succeeded:",a.id);try{console.log("\uD83D\uDCB3 Confirming payment with backend...");let e=await C.apiClient.post("/contracts/".concat(d,"/escrow/confirm-payment"),{paymentIntentId:a.id});console.log("✅ Backend confirmed payment:",e),o()}catch(e){console.error("⚠️ Backend confirmation failed, but payment succeeded:",e),o()}}}catch(e){console.error("Payment error:",e),g("An unexpected error occurred"),m("An unexpected error occurred")}finally{p(!1)}};return(0,a.jsxs)(c.Zb,{className:"w-full max-w-md mx-auto",children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(b.Z,{className:"h-5 w-5 mr-2"}),"Secure Payment"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Amount: ",r.toUpperCase()," $",l.toFixed(2)]})]}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Information"}),(0,a.jsx)("div",{className:"p-4 border border-gray-300 rounded-md",children:(0,a.jsx)(N.NZ,{options:{style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}},hidePostalCode:!0}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Postal Code / ZIP Code"}),(0,a.jsx)("input",{id:"postalCode",type:"text",value:y,onChange:e=>f(e.target.value.toUpperCase()),placeholder:"e.g., M5V 3A8 or 12345",className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your Canadian postal code (alphanumeric) or US ZIP code"})]}),j&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:j}),(0,a.jsxs)("div",{className:"flex items-center text-xs text-gray-500 mb-4",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4 mr-1"}),"Your payment information is secure and encrypted"]}),(0,a.jsx)(i.z,{type:"submit",disabled:!x||h,className:"w-full",size:"lg",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):"Pay ".concat(r.toUpperCase()," $").concat(l.toFixed(2))})]}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:[(0,a.jsx)("p",{children:"This payment will be held in escrow until project milestones are completed."}),(0,a.jsx)("p",{children:"Powered by Stripe • Your data is protected with bank-level security"})]})]})]})};var A=e=>(0,a.jsx)(N.eK,{stripe:P,children:(0,a.jsx)(S,{...e})}),D=t(94108),k=t(11532),T=t(29501),E=t(13590),I=t(67119),R=t(74291),F=t(95937),Z=t(23675),O=t(75060),Y=t(33804);let z=I.Ry({notes:I.Z_().optional(),confirmPayment:I.O7().refine(e=>!0===e,"You must confirm the payment")});function _(e){let{contractId:s,isOpen:t,onClose:l,onSuccess:r}=e,[o,m]=(0,n.useState)(null),[x,h]=(0,n.useState)(!0),[f,N]=(0,n.useState)(!1),[b,w]=(0,n.useState)(null),{register:P,handleSubmit:S,formState:{errors:A},setValue:D,watch:k}=(0,T.cI)({resolver:(0,E.F)(z)}),I=k("confirmPayment");(0,n.useEffect)(()=>{t&&_()},[t,s]);let _=async()=>{try{h(!0),w(null);let e=await C.apiClient.get("/contracts/".concat(s,"/payment-period/current"));m(e.paymentPeriod)}catch(s){var e,t;w((null===(t=s.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.message)||"Failed to load payment period data")}finally{h(!1)}},H=async e=>{if(o)try{N(!0),w(null),await C.apiClient.post("/contracts/".concat(s,"/payments/biweekly"),{periodStart:o.startDate,periodEnd:o.endDate,totalHours:o.totalHours,totalAmount:o.totalAmount,platformFee:o.platformFee,taxAmount:o.taxAmount,netAmount:o.netAmount,timeEntryIds:o.timeEntries.map(e=>e.id),notes:e.notes}),null==r||r(),l()}catch(e){var t,a;w((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Failed to process payment")}finally{N(!1)}},L=()=>{f||l()};return(0,a.jsx)(R.Vq,{open:t,onOpenChange:L,children:(0,a.jsxs)(R.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(R.fK,{children:[(0,a.jsxs)(R.$N,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"Process Biweekly Payment"]}),(0,a.jsx)(R.Be,{children:"Review and process payment for approved time entries in the current period."})]}),x?(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-5/6"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):b?(0,a.jsxs)(F.bZ,{variant:"destructive",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),(0,a.jsx)(F.X,{children:b})]}):o?(0,a.jsxs)("form",{onSubmit:S(H),className:"space-y-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5"}),"Payment Period Summary"]})}),(0,a.jsxs)(c.aY,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Period"}),(0,a.jsxs)("p",{className:"font-semibold",children:[(0,v.p6)(o.startDate)," - ",(0,v.p6)(o.endDate)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Hours"}),(0,a.jsxs)("p",{className:"font-semibold flex items-center gap-1",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),o.totalHours," hours"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-blue-600",children:"Gross Amount"}),(0,a.jsx)("p",{className:"text-lg font-bold text-blue-700",children:(0,v.xG)(o.totalAmount)})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-600",children:"Platform Fee"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-yellow-700",children:["-",(0,v.xG)(o.platformFee)]})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-red-600",children:"Tax Amount"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-red-700",children:["-",(0,v.xG)(o.taxAmount)]})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-green-600",children:"Net Payment"}),(0,a.jsx)("p",{className:"text-lg font-bold text-green-700",children:(0,v.xG)(o.netAmount)})]})]})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.Z,{className:"h-5 w-5"}),"Time Entries (",o.timeEntries.length,")"]})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)(Y.iA,{children:[(0,a.jsx)(Y.xD,{children:(0,a.jsxs)(Y.SC,{children:[(0,a.jsx)(Y.ss,{children:"Date"}),(0,a.jsx)(Y.ss,{children:"Hours"}),(0,a.jsx)(Y.ss,{children:"Status"}),(0,a.jsx)(Y.ss,{children:"Description"}),(0,a.jsx)(Y.ss,{className:"text-right",children:"Amount"})]})}),(0,a.jsx)(Y.RM,{children:o.timeEntries.map(e=>(0,a.jsxs)(Y.SC,{children:[(0,a.jsx)(Y.pj,{children:(0,v.p6)(e.date)}),(0,a.jsxs)(Y.pj,{className:"font-mono",children:[e.hours,"h"]}),(0,a.jsx)(Y.pj,{children:(0,a.jsx)(d.C,{variant:"secondary",children:e.status})}),(0,a.jsx)(Y.pj,{className:"max-w-xs",children:(0,a.jsx)("p",{className:"truncate",title:e.description,children:e.description})}),(0,a.jsx)(Y.pj,{className:"text-right font-semibold",children:(0,v.xG)(e.amount)})]},e.id))})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(O._,{htmlFor:"notes",children:"Payment Notes (Optional)"}),(0,a.jsx)(Z.g,{id:"notes",...P("notes"),placeholder:"Add any notes about this payment...",rows:3})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"confirmPayment",...P("confirmPayment"),className:"rounded border-gray-300"}),(0,a.jsxs)(O._,{htmlFor:"confirmPayment",className:"text-sm",children:["I confirm that I want to process this payment of"," ",(0,a.jsx)("span",{className:"font-semibold",children:o&&(0,v.xG)(o.netAmount)})," ","to the talent."]})]}),A.confirmPayment&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:A.confirmPayment.message}),(0,a.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[(0,a.jsx)(i.z,{type:"submit",disabled:f||!I,className:"flex-1",children:f?"Processing Payment...":"Process Payment"}),(0,a.jsx)(i.z,{type:"button",variant:"outline",onClick:L,disabled:f,children:"Cancel"})]})]}):(0,a.jsxs)(F.bZ,{children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),(0,a.jsx)(F.X,{children:"No approved time entries found for the current payment period."})]})]})})}var H=t(56422);let L=[{code:"AB",name:"Alberta"},{code:"BC",name:"British Columbia"},{code:"MB",name:"Manitoba"},{code:"NB",name:"New Brunswick"},{code:"NL",name:"Newfoundland and Labrador"},{code:"NT",name:"Northwest Territories"},{code:"NS",name:"Nova Scotia"},{code:"NU",name:"Nunavut"},{code:"ON",name:"Ontario"},{code:"PE",name:"Prince Edward Island"},{code:"QC",name:"Quebec"},{code:"SK",name:"Saskatchewan"},{code:"YT",name:"Yukon"}];function U(e){let{isOpen:s,onClose:t,onLocationUpdated:l}=e,[r,c]=(0,n.useState)(""),[d,o]=(0,n.useState)(""),[m,x]=(0,n.useState)(!1),[u,h]=(0,n.useState)(null),p=async e=>{if(e.preventDefault(),!r){h("Please select a province");return}try{x(!0),h(null),await C.apiClient.put("/users/location",{province:r,city:d||void 0}),l(),t()}catch(e){var s,a;console.error("Failed to update location:",e),h((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to update location")}finally{x(!1)}};return(0,a.jsx)(R.Vq,{open:s,onOpenChange:e=>!e&&t(),children:(0,a.jsxs)(R.cZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(R.fK,{children:[(0,a.jsxs)(R.$N,{className:"flex items-center gap-2",children:[(0,a.jsx)(H.Z,{className:"h-5 w-5"}),"Update Your Location"]}),(0,a.jsx)(R.Be,{children:"Your province is required to calculate accurate taxes for escrow funding. Please update your business location to continue."})]}),(0,a.jsxs)("form",{onSubmit:p,className:"space-y-4 mt-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"province",className:"block text-sm font-medium text-gray-700 mb-1",children:"Province / Territory *"}),(0,a.jsxs)("select",{id:"province",value:r,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select a province..."}),L.map(e=>(0,a.jsx)("option",{value:e.code,children:e.name},e.code))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"City (Optional)"}),(0,a.jsx)("input",{id:"city",type:"text",value:d,onChange:e=>o(e.target.value),placeholder:"e.g., Toronto",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:u}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end pt-4",children:[(0,a.jsx)(i.z,{type:"button",variant:"outline",onClick:t,disabled:m,children:"Cancel"}),(0,a.jsx)(i.z,{type:"submit",disabled:m||!r,children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update Location"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-xs text-blue-800",children:[(0,a.jsx)("strong",{children:"Why is this required?"})," Your province determines the applicable tax rates (GST, HST, PST) for platform fees, ensuring accurate billing and compliance with Canadian tax regulations."]})})]})})}function G(){var e,s,N,b,w,P,C,S,T,E,I,R,F;let Z=(0,l.useParams)(),O=(0,l.useRouter)(),Y=Z.id;console.log("Contract Detail Page - params:",Z),console.log("Contract Detail Page - contractId:",Y);let[z,H]=(0,n.useState)(null),[L,G]=(0,n.useState)(!0),[B,M]=(0,n.useState)(null),[q,W]=(0,n.useState)(null),[V,$]=(0,n.useState)(!1),[K,Q]=(0,n.useState)(null),[X,J]=(0,n.useState)(null),[ee,es]=(0,n.useState)(!1),[et,ea]=(0,n.useState)(!1),[en,el]=(0,n.useState)(!1);(0,n.useEffect)(()=>{Y?er():(console.error("No contractId found in params"),M("Invalid contract ID"),G(!1))},[Y]);let er=async()=>{try{G(!0);let{apiClient:e}=await Promise.resolve().then(t.bind(t,26305)),s=await e.get("/contracts/".concat(Y));H(s);try{let s=await e.get("/contracts/".concat(Y,"/escrow/status"));console.log("Escrow status loaded:",s),W(s),J(s.breakdown)}catch(e){console.error("Failed to fetch escrow status:",e)}}catch(e){console.error("Failed to fetch contract:",e),M("Failed to load contract details")}finally{G(!1)}},ei=e=>{switch(e.toLowerCase()){case"approved":return"bg-green-100 text-green-800";case"submitted":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"pending":default:return"bg-gray-100 text-gray-800";case"rejected":return"bg-red-100 text-red-800"}},ec=async(e,s,a)=>{if(confirm('Release payment for milestone "'.concat(s,'" ($').concat(a,")?\n\n")+"This will:\n• Transfer funds from escrow to talent's payout account\n• Mark milestone as approved and paid\n• Enable talent to withdraw funds\n\nEnsure deliverables have been reviewed and approved before proceeding."))try{let{apiClient:s}=await Promise.resolve().then(t.bind(t,26305)),n=await s.post("/payments/milestone/release",{milestoneId:e});console.log("✅ Milestone payment released:",n),await er(),alert("Payment of $".concat(a," has been released to the talent's payout account!\n\nThey can now withdraw these funds."))}catch(s){var n,l;console.error("Error releasing milestone payment:",s);let e=(null===(l=s.response)||void 0===l?void 0:null===(n=l.data)||void 0===n?void 0:n.error)||"Failed to release payment";alert("".concat(e,"\n\nPlease ensure:\n• Milestone has been submitted by talent\n• Talent has set up their payout account"))}},ed=()=>{O.push("/business/messages?talentId=".concat(null==z?void 0:z.talent.id))},eo=async()=>{if(z)try{$(!0);let{apiClient:e}=await Promise.resolve().then(t.bind(t,26305)),s=await e.post("/contracts/".concat(z.id,"/escrow/fund"),{});if(console.log("Stripe Payment Intent created:",s),s.clientSecret&&s.paymentIntentId)Q({id:s.paymentIntentId,clientSecret:s.clientSecret,amount:s.amount,currency:"cad"}),J(s.breakdown),es(!0);else throw console.error("Invalid response structure:",s),Error("No payment intent received from server")}catch(t){var e,s,a,n,l,r,i,c,d,o,m,x,u,h,p,j,g,y;if(console.error("Failed to create payment intent:",t),(null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.error)==="LOCATION_REQUIRED"||(null===(n=t.response)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.requiresLocationUpdate))el(!0);else if((null===(r=t.response)||void 0===r?void 0:null===(l=r.data)||void 0===l?void 0:l.error)==="ESCROW_ALREADY_FUNDED")alert("This contract's escrow has already been funded.");else if((null===(c=t.response)||void 0===c?void 0:null===(i=c.data)||void 0===i?void 0:i.error)==="TALENT_PAYOUT_NOT_SETUP"||(null===(o=t.response)||void 0===o?void 0:null===(d=o.data)||void 0===d?void 0:d.error)==="TALENT_PAYOUT_NOT_ACTIVE"||(null===(x=t.response)||void 0===x?void 0:null===(m=x.data)||void 0===m?void 0:m.requiresTalentStripeSetup)){let e=(null==z?void 0:null===(h=z.talent)||void 0===h?void 0:null===(u=h.profile)||void 0===u?void 0:u.displayName)||"the talent";alert("⚠️ Payout Account Required\n\n"+"".concat(null===(j=t.response)||void 0===j?void 0:null===(p=j.data)||void 0===p?void 0:p.message,"\n\n")+"".concat(e," needs to set up their payout account:\n")+"1. Go to their Payments page\n2. Complete Stripe Connect setup\n3. Connect their bank account\n\nThey will receive an email notification with instructions.\nOnce they complete setup, you can fund the escrow.")}else alert((null===(y=t.response)||void 0===y?void 0:null===(g=y.data)||void 0===g?void 0:g.message)||t.message||"Failed to initiate escrow funding")}finally{$(!1)}},em=async()=>{el(!1);try{console.log("\uD83D\uDCCD Location updated, refreshing contract data..."),await er(),console.log("✅ Contract refreshed, retrying escrow funding..."),await eo()}catch(e){console.error("Failed to refresh contract or fund escrow after location update:",e),alert('Location updated successfully. Please click "Fund Escrow" again to proceed.')}},ex=async()=>{try{es(!1),Q(null),J(null),await er(),alert("\uD83C\uDF89 Escrow funded successfully! The talent has been notified and can now start working.")}catch(e){console.error("Failed to refresh contract data:",e)}};return L?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):B||!z?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-600 mb-4",children:B||"Contract not found"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Contract ID: ",Y||"undefined",(0,a.jsx)("br",{}),"URL: ",window.location.pathname]}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)(i.z,{onClick:()=>O.back(),children:"Go Back"}),(0,a.jsx)(i.z,{variant:"outline",onClick:()=>O.push("/business/contracts"),children:"View All Contracts"})]})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:()=>O.back(),children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:z.title}),(0,a.jsx)("p",{className:"text-gray-600",children:"Contract Details"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(d.C,{className:(e=>{switch(e.toLowerCase()){case"active":return"bg-green-100 text-green-800";case"pending_signatures":return"bg-yellow-100 text-yellow-800";case"draft":default:return"bg-gray-100 text-gray-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";case"disputed":return"bg-orange-100 text-orange-800"}})(z.status),children:z.status.replace("_"," ").toUpperCase()}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",onClick:ed,children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Messages"]}),"pending_signatures"===z.status&&(0,a.jsxs)(i.z,{size:"sm",onClick:()=>{console.log("Sign contract:",null==z?void 0:z.id),alert("Contract signing feature coming soon!")},children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Sign Contract"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Contract Overview"})}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Description"}),(0,a.jsx)("p",{className:"text-gray-600",children:z.description})]}),z.scopeOfWork&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Scope of Work"}),(0,a.jsx)("p",{className:"text-gray-600 whitespace-pre-wrap",children:z.scopeOfWork})]}),z.deliverables&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Deliverables Summary"}),(0,a.jsx)("p",{className:"text-gray-600 whitespace-pre-wrap",children:z.deliverables})]}),z.paymentSchedule&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Payment Schedule"}),(0,a.jsx)("p",{className:"text-gray-600 whitespace-pre-wrap",children:z.paymentSchedule})]}),z.duration&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Project Duration"}),(0,a.jsx)("p",{className:"text-gray-600 whitespace-pre-wrap",children:z.duration})]}),z.terms&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Contract Terms"}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:z.terms})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Contract Parties"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Business (Client)"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Name:"})," ",z.businessName||(null===(s=z.business)||void 0===s?void 0:null===(e=s.profile)||void 0===e?void 0:e.companyName)||(null===(w=z.project)||void 0===w?void 0:null===(b=w.business)||void 0===b?void 0:null===(N=b.profile)||void 0===N?void 0:N.companyName)||"Business Name"]}),z.businessAddress&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Address:"})," ",z.businessAddress]})]})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Talent (Contractor)"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Name:"})," ",z.talentName||(null===(P=z.talent)||void 0===P?void 0:P.profile)&&("".concat(z.talent.profile.firstName||""," ").concat(z.talent.profile.lastName||"").trim()||z.talent.profile.displayName)||"Talent Name"]}),z.talentAddress&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Address:"})," ",z.talentAddress]})]})]})]})]}),(z.cancellationPolicy||z.intellectualPropertyRights||z.terms)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Legal Terms & Policies"}),(0,a.jsxs)("div",{className:"space-y-3",children:[z.cancellationPolicy&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Cancellation Policy"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:z.cancellationPolicy})]}),z.intellectualPropertyRights&&(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:"Intellectual Property Rights"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:z.intellectualPropertyRights})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Financial Details"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(null===(C=z.project)||void 0===C?void 0:C.type)==="HOURLY"?(0,a.jsxs)(a.Fragment,{children:[z.hourlyRate&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Hourly Rate:"}),(0,a.jsxs)("span",{className:"font-medium",children:[(0,v.xG)(z.hourlyRate),"/hr"]})]}),z.estimatedHours&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Estimated Hours:"}),(0,a.jsxs)("span",{className:"font-medium",children:[z.estimatedHours," hours"]})]}),z.hourlyRate&&z.estimatedHours&&(0,a.jsxs)("div",{className:"flex justify-between border-t pt-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Estimated Total:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.xG)(z.hourlyRate*z.estimatedHours)})]})]}):(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Total Amount:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.xG)(z.totalAmount)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Contract Type:"}),(0,a.jsx)("span",{className:"font-medium capitalize",children:(null===(S=z.project)||void 0===S?void 0:S.type)==="HOURLY"?"Hourly":"Fixed Price"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Timeline"}),(0,a.jsxs)("div",{className:"space-y-2",children:[z.startDate&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Start Date:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.p6)(new Date(z.startDate))})]}),z.completionDate&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Completion Date:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.p6)(new Date(z.completionDate))})]}),z.endDate&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"End Date:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.p6)(new Date(z.endDate))})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Created:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.p6)(new Date(z.createdAt))})]})]})]})]})]})]}),z.milestones&&z.milestones.length>0&&(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Project Milestones"})}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:z.milestones.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900",children:[s+1,". ",e.title]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(d.C,{className:ei(e.status),variant:"secondary",children:e.status.replace("_"," ")}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.xG)(e.amount)})]})]}),e.deliverables&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Deliverables:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.deliverables})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.dueDate&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Due: ",(0,v.p6)(new Date(e.dueDate))]})]}),e.percentage&&(0,a.jsxs)("span",{children:[e.percentage,"% of total"]})]}),("ACTIVE"===z.status||"IN_PROGRESS"===z.status)&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t",children:[(0,a.jsx)(D.i,{milestoneId:e.id,userRole:"business",canEdit:!1,onUpdate:()=>{console.log("\uD83D\uDD04 Refreshing contract after deliverable update..."),er()}}),(()=>{let t=e.payments&&e.payments.length>0,n=t&&"COMPLETED"===e.payments[0].status,l=e.deliverables||[],r=l.length>0&&l.every(e=>"APPROVED"===e.status),c=l.length>0;console.log("Milestone ".concat(s+1," status:"),e.status,"Has payment:",t,"Is paid:",n,"Deliverables:",l.length,"All approved:",r);let d="SUBMITTED"===e.status&&(!c||r);return d||n?(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:n?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5"}),(0,a.jsxs)("span",{className:"font-medium",children:["Payment Released ($",e.payments[0].amount,")"]})]}):(0,a.jsxs)(i.z,{onClick:()=>ec(e.id,e.title,e.amount),disabled:!d,className:"bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",title:d?"":c&&!r?"All deliverables must be approved":"Milestone must be submitted",children:["Complete Milestone & Release Payment ($",e.amount,")"]})}):null})()]})]},e.id))})})]}),(null===(T=z.project)||void 0===T?void 0:T.type)==="HOURLY"&&("ACTIVE"===z.status||"IN_PROGRESS"===z.status)&&(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(c.ll,{children:"Time Tracking & Payments"}),(0,a.jsx)(i.z,{onClick:()=>ea(!0),disabled:!z.hourlyRate,children:"Process Payment"})]})}),(0,a.jsx)(c.aY,{children:(0,a.jsx)(k.e,{contractId:Y,userRole:"business",canEdit:!1})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Signature Status"})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(z.businessSignedAt?"bg-green-500":"bg-gray-300")}),(0,a.jsx)("span",{className:"font-medium",children:"Business Signature"})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:z.businessSignedAt?(0,a.jsxs)("span",{className:"text-green-600",children:["Signed ",(0,v.SY)(new Date(z.businessSignedAt))]}):(0,a.jsx)("span",{children:"Pending"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(z.talentSignedAt?"bg-green-500":"bg-gray-300")}),(0,a.jsx)("span",{className:"font-medium",children:"Talent Signature"})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:z.talentSignedAt?(0,a.jsxs)("span",{className:"text-green-600",children:["Signed ",(0,v.SY)(new Date(z.talentSignedAt))]}):(0,a.jsx)("span",{children:"Pending"})})]})]})})]}),"ACTIVE"===z.status&&z.businessSignedAt&&z.talentSignedAt&&(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsxs)(c.ll,{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5 mr-2"}),"Escrow Funding"]})}),(0,a.jsx)(c.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:(null==q?void 0:q.needsFunding)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5 text-yellow-500 mt-0.5 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-800",children:"Escrow Funding Required"}),(0,a.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:"To activate this project, you must fund the escrow account with the full contract amount. This ensures secure payment to the talent upon milestone completion."})]})]})}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:(null===(E=z.project)||void 0===E?void 0:E.type)==="HOURLY"?"Estimated Total Amount:":"Total Contract Amount:"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gray-900",children:(()=>{var e,s;let t=z.estimatedHours||(null===(e=z.application)||void 0===e?void 0:e.estimatedHours);return(null===(s=z.project)||void 0===s?void 0:s.type)==="HOURLY"&&z.hourlyRate&&t?(0,v.xG)(z.hourlyRate*t):(0,v.xG)(z.totalAmount)})()})]}),(()=>{var e,s;let t=z.estimatedHours||(null===(e=z.application)||void 0===e?void 0:e.estimatedHours);return(null===(s=z.project)||void 0===s?void 0:s.type)==="HOURLY"&&z.hourlyRate&&t&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:["Based on ",t," hours \xd7 ",(0,v.xG)(z.hourlyRate),"/hr"]})})(),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["This amount will be held in escrow and released to the talent as ",(null===(I=z.project)||void 0===I?void 0:I.type)==="HOURLY"?"time is tracked and approved":"milestones are completed and approved","."]}),(0,a.jsx)(i.z,{onClick:eo,disabled:V,className:"w-full",size:"lg",children:V?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Fund Escrow - ",(()=>{var e,s;let t=z.estimatedHours||(null===(e=z.application)||void 0===e?void 0:e.estimatedHours);return(null===(s=z.project)||void 0===s?void 0:s.type)==="HOURLY"&&z.hourlyRate&&t?(0,v.xG)(z.hourlyRate*t):(0,v.xG)(z.totalAmount)})()]})})]}),ee&&K&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Complete Payment"}),X&&(0,a.jsxs)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Payment Breakdown"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Project Amount:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.xG)(X.escrowAmount)})]}),X.platformFee&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Platform Fee:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.xG)(X.platformFee.baseFee)})]}),X.platformFee.taxAmount>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Tax:"}),(0,a.jsx)("span",{className:"font-medium",children:(0,v.xG)(X.platformFee.taxAmount)})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:X.platformFee.description})]}),(0,a.jsxs)("div",{className:"border-t border-blue-300 pt-2 mt-2 flex justify-between font-semibold text-base",children:[(0,a.jsx)("span",{className:"text-gray-900",children:"Total Amount:"}),(0,a.jsx)("span",{className:"text-blue-600",children:(0,v.xG)(X.totalAmount)})]})]}),X.chargeDescription&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-blue-200",children:(0,a.jsx)("p",{className:"text-xs text-gray-600",children:X.chargeDescription})})]}),(0,a.jsx)(A,{paymentIntentId:K.id,clientSecret:K.clientSecret,amount:K.amount,currency:K.currency,contractId:z.id,onSuccess:ex,onError:e=>{console.error("Payment failed:",e),alert("Payment failed: ".concat(e)),es(!1),Q(null)}}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)(i.z,{variant:"outline",onClick:()=>{es(!1),Q(null),J(null)},children:"Cancel Payment"})})]})]}):(null==q?void 0:q.canStartProject)?(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5 text-green-500 mt-0.5 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-green-800",children:"Escrow Funded Successfully"}),(0,a.jsxs)("p",{className:"text-sm text-green-700 mt-1",children:["The escrow account has been funded with ",(0,v.xG)((null===(R=q.escrowAccount)||void 0===R?void 0:R.totalAmount)?Number(q.escrowAccount.totalAmount):Number(z.totalAmount)),". The talent has been notified and can now start working on the project."]}),(null===(F=q.escrowAccount)||void 0===F?void 0:F.fundedAt)&&(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-2",children:["Funded: ",(0,v.SY)(new Date(q.escrowAccount.fundedAt))]})]})]})}):(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-blue-500 mt-0.5 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-blue-800",children:"Escrow Processing"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"Escrow funding is being processed. This may take a few minutes to complete."})]})]})})})})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Project"})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:z.project.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:z.project.description})]}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",asChild:!0,className:"w-full",children:(0,a.jsxs)(r.default,{href:"/business/projects/".concat(z.project.id),children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"View Project"]})})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Talent"})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[z.talent.profile.avatar?(0,a.jsx)("img",{src:z.talent.profile.avatar,alt:z.talent.profile.displayName,className:"w-10 h-10 rounded-full"}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)(f.Z,{className:"h-5 w-5 text-gray-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:z.talent.profile.displayName}),z.talent.profile.title&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:z.talent.profile.title})]})]}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",asChild:!0,className:"w-full",children:(0,a.jsxs)(r.default,{href:"/business/talent/".concat(z.talent.id),children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"View Profile"]})})]})})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsx)(c.Ol,{children:(0,a.jsx)(c.ll,{children:"Quick Actions"})}),(0,a.jsx)(c.aY,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(i.z,{variant:"outline",size:"sm",className:"w-full",onClick:ed,children:[(0,a.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Send Message"]}),(0,a.jsxs)(i.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{console.log("Download contract:",null==z?void 0:z.id),alert("Contract download feature coming soon!")},children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Download Contract"]}),"active"===z.status&&(0,a.jsxs)(i.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{O.push("/business/contracts/".concat(null==z?void 0:z.id,"/edit"))},children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Modify Contract"]})]})})]})]})]}),(0,a.jsx)(_,{contractId:Y,isOpen:et,onClose:()=>ea(!1),onSuccess:()=>{ea(!1),er()}}),(0,a.jsx)(U,{isOpen:en,onClose:()=>el(!1),onLocationUpdated:em})]})}},26305:function(e,s,t){"use strict";t.d(s,{apiClient:function(){return l}});var a=t(83464);class n{async get(e,s){return(await this.client.get(e,s)).data}async post(e,s,t){return(await this.client.post(e,s,t)).data}async put(e,s,t){return(await this.client.put(e,s,t)).data}async patch(e,s,t){return(await this.client.patch(e,s,t)).data}async delete(e,s){return(await this.client.delete(e,s)).data}async getBlob(e,s){return(await this.client.get(e,{...s,responseType:"blob"})).data}constructor(){this.client=a.Z.create({baseURL:"http://localhost:5000/api",timeout:1e4,withCredentials:!0}),this.client.interceptors.request.use(e=>{let s=localStorage.getItem("token")||sessionStorage.getItem("token")||localStorage.getItem("localtalents_token")||localStorage.getItem("accessToken")||localStorage.getItem("localtalents_accessToken");return console.log("\uD83D\uDD0D API Client: Request interceptor",{url:e.url,hasToken:!!s}),s?(e.headers.Authorization="Bearer ".concat(s),console.log("✅ API Client: Added Authorization header")):console.log("❌ API Client: No token found in any storage location"),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var s,t;let n=e.config;if((null===(s=e.response)||void 0===s?void 0:s.status)===401&&!n._retry){n._retry=!0;try{let e=localStorage.getItem("refreshToken");if(e){let{accessToken:s}=(await a.Z.post("".concat(this.client.defaults.baseURL,"/auth/refresh"),{refreshToken:e})).data.tokens;return localStorage.setItem("token",s),n.headers.Authorization="Bearer ".concat(s),this.client(n)}}catch(s){localStorage.removeItem("token"),localStorage.removeItem("refreshToken");let e=window.location.pathname;return(e.startsWith("/business")||e.startsWith("/talent")||e.startsWith("/admin"))&&(window.location.href="/login"),Promise.reject(s)}}if((null===(t=e.response)||void 0===t?void 0:t.status)===401){let e=window.location.pathname,s=e.startsWith("/business")||e.startsWith("/talent")||e.startsWith("/admin");localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),s&&(window.location.href="/login")}return Promise.reject(e)})}}let l=new n}},function(e){e.O(0,[6137,3464,2972,4690,7983,4200,7626,5480,5924,4297,2971,2117,1744],function(){return e(e.s=83040)}),_N_E=e.O()}]);